(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216276"],{c0f9:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",{staticClass:"app-container"},[r("el-row",{staticClass:"app-bar",attrs:{type:"flex",justify:"end"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("添加")])],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"","highlight-current-row":"",data:e.tableData}},[r("el-table-column",{attrs:{prop:"name",label:"项目名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"url",label:"项目地址"}}),e._v(" "),r("el-table-column",{attrs:{prop:"path",width:"200",label:"部署路径"}}),e._v(" "),r("el-table-column",{attrs:{prop:"status",label:"状态",width:"90"}}),e._v(" "),r("el-table-column",{attrs:{prop:"createTime",width:"160",label:"创建时间"}}),e._v(" "),r("el-table-column",{attrs:{prop:"updateTime",width:"160",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{prop:"operation",label:"操作",width:"430"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{disabled:"初始化成功"===t.row.status,size:"small",type:"success"},on:{click:function(r){return e.create(t.row.id)}}},[e._v("初始化")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.handleServer(t.row)}}},[e._v("服务器管理")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.handleUser(t.row)}}},[e._v("成员管理")]),e._v(" "),r("el-button",{attrs:{type:"danger"}},[e._v("删除")])]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:"项目设置",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{rules:e.formRules,model:e.formData,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"项目地址",prop:"url"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formData.url,callback:function(t){e.$set(e.formData,"url",t)},expression:"formData.url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"部署路径",prop:"path"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formData.path,callback:function(t){e.$set(e.formData,"path",t)},expression:"formData.path"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"脚本路径",prop:"scrpit"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formData.script,callback:function(t){e.$set(e.formData,"script",t)},expression:"formData.script"}})],1),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.formProps.showServers,expression:"formProps.showServers"}],attrs:{label:"绑定服务器",prop:"serverIds"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"选择服务器，可多选"},model:{value:e.formData.serverIds,callback:function(t){e.$set(e.formData,"serverIds",t)},expression:"formData.serverIds"}},e._l(e.serverOption,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.formProps.showUsers,expression:"formProps.showUsers"}],attrs:{label:"绑定组员",prop:"userIds"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"选择组员，可多选"},model:{value:e.formData.userIds,callback:function(t){e.$set(e.formData,"userIds",t)},expression:"formData.userIds"}},e._l(e.userOption,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{disabled:e.formProps.disabled,type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"服务器管理",visible:e.dialogServerVisible},on:{"update:visible":function(t){e.dialogServerVisible=t}}},[r("el-row",{staticClass:"app-bar",attrs:{type:"flex",justify:"end"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAddServer}},[e._v("添加")])],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"","highlight-current-row":"",data:e.tableServerData}},[r("el-table-column",{attrs:{prop:"serverId",label:"服务器ID"}}),e._v(" "),r("el-table-column",{attrs:{prop:"serverName",label:"服务器名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"createTime",width:"160",label:"绑定时间"}}),e._v(" "),r("el-table-column",{attrs:{prop:"updateTime",width:"160",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{prop:"operation",label:"操作",width:"75"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger"},on:{click:function(r){return e.removeProjectServer(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogServerVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"成员管理",visible:e.dialogUserVisible},on:{"update:visible":function(t){e.dialogUserVisible=t}}},[r("el-row",{staticClass:"app-bar",attrs:{type:"flex",justify:"end"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAddUser}},[e._v("添加")])],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"","highlight-current-row":"",data:e.tableUserData}},[r("el-table-column",{attrs:{prop:"userId",label:"用户ID"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userName",label:"用户名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"createTime",width:"160",label:"绑定时间"}}),e._v(" "),r("el-table-column",{attrs:{prop:"updateTime",width:"160",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{prop:"operation",label:"操作",width:"75"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger"},on:{click:function(r){return e.removeProjectUser(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogUserVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加服务器",visible:e.dialogAddServerVisible},on:{"update:visible":function(t){e.dialogAddServerVisible=t}}},[r("el-form",{ref:"addServerForm",attrs:{rules:e.addServerFormRules,model:e.addServerFormData}},[r("el-form-item",{attrs:{label:"绑定服务器","label-width":"120px",prop:"serverIds"}},[r("el-select",{attrs:{multiple:"",placeholder:"选择服务器，可多选"},model:{value:e.addServerFormData.serverIds,callback:function(t){e.$set(e.addServerFormData,"serverIds",t)},expression:"addServerFormData.serverIds"}},e._l(e.serverOption,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogAddServerVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{disabled:e.addServerFormProps.disabled,type:"primary"},on:{click:e.addServer}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加用户",visible:e.dialogAddUserVisible},on:{"update:visible":function(t){e.dialogAddUserVisible=t}}},[r("el-form",{ref:"addUserForm",attrs:{rules:e.addUserFormRules,model:e.addUserFormData}},[r("el-form-item",{attrs:{label:"绑定组员","label-width":"120px",prop:"userIds"}},[r("el-select",{attrs:{multiple:"",placeholder:"选择组员，可多选"},model:{value:e.addUserFormData.userIds,callback:function(t){e.$set(e.addUserFormData,"userIds",t)},expression:"addUserFormData.userIds"}},e._l(e.userOption,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogAddUserVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{disabled:e.addUserFormProps.disabled,type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1)],1)},s=[],o=(r("ac6a"),r("c24f")),i=r("aa22"),l=r("b775");function n(){return Object(l["a"])({url:"/project/getList",method:"get",params:{}})}function d(e){return Object(l["a"])({url:"/project/getBindServerList",method:"get",params:{id:e}})}function c(e){return Object(l["a"])({url:"/project/getBindUserList",method:"get",params:{id:e}})}function u(e){return Object(l["a"])({url:"/project/create",method:"post",data:{id:e}})}function m(e){return Object(l["a"])({url:"/project/add",method:"post",data:e})}function p(e){return Object(l["a"])({url:"/project/edit",method:"post",data:e})}function f(e){return Object(l["a"])({url:"/project/addServer",method:"post",data:e})}function v(e){return Object(l["a"])({url:"/project/addUser",method:"post",data:e})}function b(e){return Object(l["a"])({url:"/project/removeProjectUser",method:"post",data:{projectUserId:e}})}function h(e){return Object(l["a"])({url:"/project/removeProjectServer",method:"post",data:{projectServerId:e}})}var g=r("ed08"),_=["未初始化","初始化中","初始化成功","初始化失败"],y={data:function(){return{dialogVisible:!1,dialogServerVisible:!1,dialogUserVisible:!1,dialogAddServerVisible:!1,dialogAddUserVisible:!1,serverOption:[],userOption:[],tableData:[],tableServerData:[],tableUserData:[],formProps:{disabled:!1,showServers:!0,showUsers:!0},tempFormData:{},formData:{id:0,name:"",url:"",path:"",script:"",serverIds:[],userIds:[]},formRules:{name:[{required:!0,message:"请输入项目名称",trigger:["blur"]}],url:[{required:!0,message:"请输入项目地址",trigger:["blur"]}],path:[{required:!0,message:"请输入部署路径",trigger:["blur"]}],serverIds:[{type:"array",message:"请选择服务器",trigger:"change"}],userIds:[{type:"array",message:"请选择组员",trigger:"change"}]},addServerFormProps:{disabled:!1},addServerFormData:{projectId:0,serverIds:[]},addServerFormRules:{serverIds:[{type:"array",required:!0,message:"请选择服务器",trigger:"change"}]},addUserFormProps:{disabled:!1},addUserFormData:{projectId:0,userIds:[]},addUserFormRules:{userIds:[{type:"array",required:!0,message:"请选择用户",trigger:"change"}]}}},created:function(){this.storeFormData(),this.get()},methods:{handleAdd:function(){this.restoreFormData(),this.formProps.showServers=this.formProps.showUsers=!0,this.dialogVisible=!0},handleEdit:function(e){this.formData=Object.assign({},e),this.formProps.showServers=this.formProps.showUsers=!1,this.dialogVisible=!0},handleServer:function(e){this.getBindServerList(e.id),this.addServerFormData.projectId=e.id,this.dialogServerVisible=!0},handleUser:function(e){this.getBindUserList(e.id),this.addUserFormData.projectId=e.id,this.dialogUserVisible=!0},handleAddServer:function(){this.dialogAddServerVisible=!0},handleAddUser:function(){this.dialogAddUserVisible=!0},submit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;0===e.formData.id?e.add():e.edit()})},add:function(){var e=this;this.formProps.disabled=!0,m(this.formData).then(function(t){e.dialogVisible=!1,e.$message({message:t.message,type:"success",duration:5e3}),e.getProjectList()}).finally(function(){e.formProps.disabled=!1})},edit:function(){var e=this;this.formProps.disabled=!0,p(this.formData).then(function(t){e.dialogVisible=!1,e.$message({message:t.message,type:"success",duration:5e3}),e.getProjectList()}).finally(function(){e.formProps.disabled=!1})},create:function(e){var t=this;u(e).then(function(e){t.$message({message:e.message,type:"success",duration:5e3})})},addServer:function(){var e=this;this.$refs.addServerForm.validate(function(t){if(!t)return!1;e.addServerFormProps.disabled=!0,f(e.addServerFormData).then(function(t){e.dialogAddServerVisible=!1,e.$message({message:t.message,type:"success",duration:5e3}),e.getBindServerList(e.addServerFormData.projectId)}).finally(function(){e.addServerFormProps.disabled=!1})})},addUser:function(){var e=this;this.$refs.addUserForm.validate(function(t){if(!t)return!1;e.addUserFormProps.disabled=!0,v(e.addUserFormData).then(function(t){e.dialogAddUserVisible=!1,e.$message({message:t.message,type:"success",duration:5e3}),e.getBindUserList(e.addUserFormData.projectId)}).finally(function(){e.addUserFormProps.disabled=!1})})},removeProjectServer:function(e){var t=this;this.$confirm("此操作将永久删除该服务器的绑定关系, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){h(e.id).then(function(r){t.$message({message:r.message,type:"success",duration:5e3}),t.getBindServerList(e.projectId)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},removeProjectUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户的绑定关系, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){b(e.id).then(function(r){t.$message({message:r.message,type:"success",duration:5e3}),t.getBindUserList(e.projectId)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},get:function(){var e=this;this.getProjectList(),Object(i["d"])().then(function(t){e.serverOption=t.data.serverList}),Object(o["f"])().then(function(t){e.userOption=t.data.userList})},getProjectList:function(){var e=this;n().then(function(t){var r=t.data.projectList;r.forEach(function(e){e.createTime=Object(g["a"])(e.createTime),e.updateTime=Object(g["a"])(e.updateTime),e.status=_[e.status]}),e.tableData=r}).catch(function(){})},getBindServerList:function(e){var t=this;d(e).then(function(e){t.tableServerData=e.data.projectServerMap||[],t.tableServerData.forEach(function(e){e.createTime=Object(g["a"])(e.createTime),e.updateTime=Object(g["a"])(e.updateTime)})})},getBindUserList:function(e){var t=this;c(e).then(function(e){t.tableUserData=e.data.projectUserMap||[],t.tableUserData.forEach(function(e){e.createTime=Object(g["a"])(e.createTime),e.updateTime=Object(g["a"])(e.updateTime)})})},storeFormData:function(){this.tempFormData=JSON.parse(JSON.stringify(this.formData))},restoreFormData:function(){this.formData=JSON.parse(JSON.stringify(this.tempFormData))}}},S=y,D=r("2877"),w=Object(D["a"])(S,a,s,!1,null,null,null);t["default"]=w.exports}}]);