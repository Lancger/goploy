(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e14651f4"],{"013f":function(t,e,n){var r=n("4ce5"),o=n("224c"),i=n("008a"),a=n("eafa"),l=n("5dd2");t.exports=function(t,e){var n=1==t,c=2==t,s=3==t,u=4==t,f=6==t,p=5==t||f,m=e||l;return function(e,l,d){for(var b,v,h=i(e),g=o(h),y=r(l,d,3),_=a(g.length),w=0,S=n?m(e,_):c?m(e,0):void 0;_>w;w++)if((p||w in g)&&(b=g[w],v=y(b,w,h),t))if(n)S[w]=v;else if(v)switch(t){case 3:return!0;case 5:return b;case 6:return w;case 2:S.push(b)}else if(u)return!1;return f?-1:s||u?u:S}}},"06a2":function(t,e,n){"use strict";var r=n("fc81")(!0);n("492d")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},"0b53":function(t,e,n){"use strict";var r=n("e7ad"),o=n("e042"),i=n("149f"),a=n("e46b"),l=n("bf16"),c=n("f71f").KEY,s=n("238a"),u=n("6798"),f=n("399f"),p=n("ec45"),m=n("cb3d"),d=n("a08d"),b=n("4d34"),v=n("f091"),h=n("2346"),g=n("69b3"),y=n("fb68"),_=n("008a"),w=n("09b9"),S=n("94b3"),O=n("cc33"),T=n("e005"),k=n("9370"),x=n("dcb7"),j=n("2f77"),D=n("064e"),L=n("80a9"),P=x.f,I=D.f,N=k.f,C=r.Symbol,A=r.JSON,E=A&&A.stringify,H="prototype",F=m("_hidden"),M=m("toPrimitive"),R={}.propertyIsEnumerable,V=u("symbol-registry"),J=u("symbols"),$=u("op-symbols"),W=Object[H],G="function"==typeof C&&!!j.f,B=r.QObject,K=!B||!B[H]||!B[H].findChild,U=i&&s((function(){return 7!=T(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=P(W,e);r&&delete W[e],I(t,e,n),r&&t!==W&&I(W,e,r)}:I,Y=function(t){var e=J[t]=T(C[H]);return e._k=t,e},z=G&&"symbol"==typeof C.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof C},Q=function(t,e,n){return t===W&&Q($,e,n),g(t),e=S(e,!0),g(n),o(J,e)?(n.enumerable?(o(t,F)&&t[F][e]&&(t[F][e]=!1),n=T(n,{enumerable:O(0,!1)})):(o(t,F)||I(t,F,O(1,{})),t[F][e]=!0),U(t,e,n)):I(t,e,n)},q=function(t,e){g(t);var n,r=v(e=w(e)),o=0,i=r.length;while(i>o)Q(t,n=r[o++],e[n]);return t},X=function(t,e){return void 0===e?T(t):q(T(t),e)},Z=function(t){var e=R.call(this,t=S(t,!0));return!(this===W&&o(J,t)&&!o($,t))&&(!(e||!o(this,t)||!o(J,t)||o(this,F)&&this[F][t])||e)},tt=function(t,e){if(t=w(t),e=S(e,!0),t!==W||!o(J,e)||o($,e)){var n=P(t,e);return!n||!o(J,e)||o(t,F)&&t[F][e]||(n.enumerable=!0),n}},et=function(t){var e,n=N(w(t)),r=[],i=0;while(n.length>i)o(J,e=n[i++])||e==F||e==c||r.push(e);return r},nt=function(t){var e,n=t===W,r=N(n?$:w(t)),i=[],a=0;while(r.length>a)!o(J,e=r[a++])||n&&!o(W,e)||i.push(J[e]);return i};G||(C=function(){if(this instanceof C)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===W&&e.call($,n),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,n))};return i&&K&&U(W,t,{configurable:!0,set:e}),Y(t)},l(C[H],"toString",(function(){return this._k})),x.f=tt,D.f=Q,n("2ea2").f=k.f=et,n("4f18").f=Z,j.f=nt,i&&!n("550e")&&l(W,"propertyIsEnumerable",Z,!0),d.f=function(t){return Y(m(t))}),a(a.G+a.W+a.F*!G,{Symbol:C});for(var rt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ot=0;rt.length>ot;)m(rt[ot++]);for(var it=L(m.store),at=0;it.length>at;)b(it[at++]);a(a.S+a.F*!G,"Symbol",{for:function(t){return o(V,t+="")?V[t]:V[t]=C(t)},keyFor:function(t){if(!z(t))throw TypeError(t+" is not a symbol!");for(var e in V)if(V[e]===t)return e},useSetter:function(){K=!0},useSimple:function(){K=!1}}),a(a.S+a.F*!G,"Object",{create:X,defineProperty:Q,defineProperties:q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:nt});var lt=s((function(){j.f(1)}));a(a.S+a.F*lt,"Object",{getOwnPropertySymbols:function(t){return j.f(_(t))}}),A&&a(a.S+a.F*(!G||s((function(){var t=C();return"[null]"!=E([t])||"{}"!=E({a:t})||"{}"!=E(Object(t))}))),"JSON",{stringify:function(t){var e,n,r=[t],o=1;while(arguments.length>o)r.push(arguments[o++]);if(n=e=r[1],(y(e)||void 0!==t)&&!z(t))return h(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!z(e))return e}),r[1]=e,E.apply(A,r)}}),C[H][M]||n("86d4")(C[H],M,C[H].valueOf),f(C,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},2346:function(t,e,n){var r=n("75c4");t.exports=Array.isArray||function(t){return"Array"==r(t)}},"23ba":function(t,e,n){"use strict";n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return f})),n.d(e,"f",(function(){return p}));n("5ab2"),n("6d57"),n("e10e");var r=n("88d6"),o=n("b775");function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t){return Object(o["a"])({url:"/group/getList",method:"get",params:a({},t)})}function c(){return Object(o["a"])({url:"/group/getOption",method:"get"})}function s(){return Object(o["a"])({url:"/group/getDeployOption",method:"get"})}function u(t){return Object(o["a"])({url:"/group/add",method:"post",data:t})}function f(t){return Object(o["a"])({url:"/group/edit",method:"post",data:t})}function p(t){return Object(o["a"])({url:"/group/remove",method:"delete",data:{id:t}})}},"309f":function(t,e,n){n("4d34")("asyncIterator")},"4d34":function(t,e,n){var r=n("e7ad"),o=n("7ddc"),i=n("550e"),a=n("a08d"),l=n("064e").f;t.exports=function(t){var e=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||l(e,t,{value:a.f(t)})}},"5dd2":function(t,e,n){var r=n("81dc");t.exports=function(t,e){return new(r(t))(e)}},"81dc":function(t,e,n){var r=n("fb68"),o=n("2346"),i=n("cb3d")("species");t.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),r(e)&&(e=e[i],null===e&&(e=void 0))),void 0===e?Array:e}},9370:function(t,e,n){var r=n("09b9"),o=n("2ea2").f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(t){try{return o(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==i.call(t)?l(t):o(r(t))}},"9b7a":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",{staticClass:"app-container"},[n("el-row",{staticClass:"app-bar",attrs:{type:"flex"}},[n("el-select",{attrs:{placeholder:"选择分组"},on:{change:t.handleGroupChange},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},[n("el-option",{attrs:{label:"默认",value:0}}),t._v(" "),t._l(t.groupOption,(function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],2),t._v(" "),n("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入项目名称"},on:{change:t.getList},model:{value:t.projectName,callback:function(e){t.projectName=e},expression:"projectName"}})],1),t._v(" "),n("el-table",{key:t.tableHeight,staticStyle:{width:"100%","margin-top":"5px"},attrs:{border:"",stripe:"","highlight-current-row":"","max-height":t.tableHeight,data:t.tableData}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"项目名称","min-width":"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return["生产环境"===e.row.environment?n("b",{staticStyle:{color:"#F56C6C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):"测试环境"===e.row.environment?n("b",{staticStyle:{color:"#E6A23C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):n("b",{staticStyle:{color:"#909399"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"group",label:"分组"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.findGroupName(e.row.groupId))+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"branch",label:"分支"}}),t._v(" "),n("el-table-column",{attrs:{prop:"publisherName",label:"构建者",width:"160"}}),t._v(" "),n("el-table-column",{attrs:{prop:"deployState",label:"构建状态",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.deployState?n("el-tag",{attrs:{type:"info",effect:"plain"}},[t._v("未构建")]):1===e.row.deployState?n("el-tag",{attrs:{type:"warning",effect:"plain"}},[t._v("构建中")]):2===e.row.deployState?n("el-tag",{attrs:{type:"success",effect:"plain"}},[t._v("成功")]):n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"updateTime",label:"上次构建时间",width:"160"}}),t._v(" "),n("el-table-column",{attrs:{prop:"operation",label:"操作",width:"165",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-row",{staticClass:"operation-btn"},[n("el-dropdown",{attrs:{"split-button":"",trigger:"click",disabled:1===e.row.deployState,type:"primary"},on:{click:function(n){return t.publish(e.row)},command:t.handlePublishCommand}},[t._v("\n            构建\n            "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:e.row}},[t._v("选择具体commit")])],1)],1),t._v(" "),n("el-button",{attrs:{type:"success"},on:{click:function(n){return t.handleDetail(e.row)}}},[t._v("详情")])],1)]}}])})],1),t._v(" "),n("el-dialog",{staticClass:"publish-record",attrs:{title:"构建记录",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-row",[n("el-col",{attrs:{span:8}},[n("el-radio-group",{on:{change:t.handleDetailChange},model:{value:t.publishToken,callback:function(e){t.publishToken=e},expression:"publishToken"}},t._l(t.gitTraceList,(function(e,r){return n("el-row",{key:r},[n("el-row",{staticStyle:{margin:"5px 0"}},[n("el-radio",{staticStyle:{"margin-left":"10px","margin-right":"5px","padding-right":"8px",width:"210px"},attrs:{label:e.token,border:""}},[t._v("\n                "+t._s(e.publisherName)+" commitID: "+t._s(e.commit)+"\n                "),1===e.publishState?n("span",{staticStyle:{color:"#67C23A",float:"right","line-height":"16px"}},[t._v("成功")]):n("span",{staticStyle:{color:"#F56C6C",float:"right","line-height":"16px"}},[t._v("失败")])]),t._v(" "),n("el-button",{attrs:{type:"danger",plain:""},on:{click:function(n){return t.rollback(e)}}},[t._v("rebuild")])],1)],1)})),1)],1),t._v(" "),n("el-col",{staticClass:"project-detail",attrs:{span:16}},[t._l(t.publishLocalTraceList,(function(e,r){return n("el-row",{key:r},[2===e.type?n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("git同步信息")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),0!==e.state?n("el-row",[n("el-row",[t._v("commit: "+t._s(e["commit"]))]),t._v(" "),n("el-row",[t._v("message: "+t._s(e["message"]))]),t._v(" "),n("el-row",[t._v("author: "+t._s(e["author"]))]),t._v(" "),n("el-row",[t._v("datetime: "+t._s(e["timestamp"]?t.parseTime(e["timestamp"]):""))]),t._v(" "),n("el-row",[n("span",{domProps:{innerHTML:t._s(t.formatDetail(e["diff"]))}})])],1):n("el-row",{staticStyle:{margin:"5px 0"}},[n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):t._e(),t._v(" "),3===e.type?n("el-row",[n("hr"),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("获取代码后脚本信息")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("脚本: "),n("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("el-row",[t._v("[goploy ~]# "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):t._e(),t._v(" "),6===e.type?n("el-row",[n("hr"),t._v(" "),n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("remote服务器信息")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("服务器: "+t._s(e.serverName))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("脚本: "+t._s(e.script))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1)],1):t._e()],1)})),t._v(" "),n("hr"),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("目标服务器")]),t._v(" "),n("el-tabs",{model:{value:t.activeRomoteTracePane,callback:function(e){t.activeRomoteTracePane=e},expression:"activeRomoteTracePane"}},t._l(t.publishRemoteTraceList,(function(e,r){return n("el-tab-pane",{key:r,attrs:{label:r,name:r}},t._l(e,(function(e,r){return n("el-row",{key:r},[4===e.type?n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署前脚本")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("脚本: "),n("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("el-row",[t._v("[goploy ~]# "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):5===e.type?n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("rsync同步文件")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("命令: "+t._s(e.command))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署后脚本")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("脚本: "+t._s(e.script))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("el-row",[t._v("[goploy ~]# "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1)],1)})),1)})),1)],2)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"commit管理",visible:t.commitDialogVisible},on:{"update:visible":function(e){t.commitDialogVisible=e}}},[n("el-table",{attrs:{border:"",stripe:"","highlight-current-row":"","max-height":"447px",data:t.commitTableData}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.row.diff))}})]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"commit",label:"commit",width:"290"}}),t._v(" "),n("el-table-column",{attrs:{prop:"author",label:"author"}}),t._v(" "),n("el-table-column",{attrs:{label:"提交时间",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.parseTime(e.row.timestamp))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"message",label:"message",width:"200","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{prop:"operation",label:"操作",width:"80",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"danger"},on:{click:function(n){return t.rollback(e.row)}}},[t._v("构建")])]}}])})],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.commitDialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},o=[],i=(n("309f"),n("0b53"),n("06a2"),n("ec25"),n("2b45"),n("f548"),n("e697"),n("e10e"),n("cc57"),n("6d57"),n("e204"),{data:function(){return{tableHeight:window.innerHeight-160}},mounted:function(){try{var t=document.getElementsByClassName("app-bar")[0].clientHeight+140,e=window.innerHeight-t;this.tableHeight=e}catch(n){console.log("缺少节点app-bar")}}}),a=n("b775");function l(t,e){return Object(a["a"])({url:"/deploy/getList",method:"get",params:{groupId:t,projectName:e}})}function c(t){return Object(a["a"])({url:"/deploy/getDetail",method:"get",params:{lastPublishToken:t}})}function s(t){return Object(a["a"])({url:"/deploy/getPreview",method:"get",params:{projectId:t}})}function u(t){return Object(a["a"])({url:"/deploy/getCommitList",method:"get",params:{id:t}})}function f(t,e){return Object(a["a"])({url:"/deploy/publish",method:"post",data:{projectId:t,commit:e}})}var p=n("23ba"),m=n("ed08");function d(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=b(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function b(t,e){if(t){if("string"===typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var h={mixins:[i],data:function(){return{groupId:parseInt(localStorage.getItem("groupId"))||0,groupOption:[],projectName:"",publishToken:"",commitDialogVisible:!1,dialogVisible:!1,webSocket:null,tableData:[],commitTableData:[],gitTraceList:[],publishTraceList:[],publishLocalTraceList:[],publishRemoteTraceList:{},activeRomoteTracePane:""}},created:function(){var t=this;this.getList(),this.getDeployGroupOption(),this.connectWebSocket(),this.$router.afterEach((function(){t.webSocket&&t.webSocket.close()}))},methods:{parseTime:m["c"],connectWebSocket:function(){var t=this;return this.webSocket&&this.webSocket.readyState<2?(console.log("reusing the socket connection [state = "+this.webSocket.readyState+"]: "+this.webSocket.url),Promise.resolve(this.webSocket)):new Promise((function(e,n){t.webSocket=new WebSocket("ws://"+window.location.host+"/ws/broadcast"),t.webSocket.onopen=function(){console.log("socket connection is opened [state = "+t.webSocket.readyState+"]: "+t.webSocket.url),e(t.webSocket)},t.webSocket.onerror=function(t){console.error("socket connection error : ",t),n(t)},t.webSocket.onclose=function(e){t.webSocket=null,console.log("connection closed ("+e.code+")")},t.webSocket.onmessage=function(e){var n=JSON.parse(e.data);console.log(n),n.message=t.formatDetail(n.message),3===n.state&&t.$notify.error({title:n.projectName,dangerouslyUseHTMLString:!0,message:n.message,duration:0});var r=t.tableData.findIndex((function(t){return t.id===n.projectId}));-1!==r&&(t.tableData[r].deployState=n.state,t.tableData[r].publisherName=n.username,t.tableData[r].updateTime=Object(m["c"])(new Date))}}))},handleGroupChange:function(t){localStorage.setItem("groupId",t),this.groupId=t,this.getList()},getDeployGroupOption:function(){var t=this;Object(p["c"])().then((function(e){t.groupOption=e.data.groupList||[]}))},getList:function(){var t=this;l(this.groupId,this.projectName).then((function(e){var n=e.data.projectList||[];n.forEach((function(t){t.createTime=Object(m["c"])(t.createTime),t.updateTime=Object(m["c"])(t.updateTime)})),t.tableData=n}))},publish:function(t){var e=this,n=t.id,r=this.$createElement,o="";o="生产环境"===t.environment?"color: #F56C6C":"测试环境"===t.environment?"color: #E6A23C":"color: #909399",this.$confirm("","提示",{message:r("p",null,[r("span",null,"此操作将部署 "+t.name),r("b",{style:o},"("+t.environment+")"),r("span",null,", 是否继续? ")]),confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.gitLog=[],e.remoteLog={},e.connectWebSocket().then((function(t){f(n,"").then((function(t){var r=e.tableData.findIndex((function(t){return t.id===n}));e.tableData[r].deployState=1}))}))})).catch((function(){e.$message({type:"info",message:"已取消构建"})}))},getDetail:function(){var t=this;c(this.publishToken).then((function(e){var n=e.data.publishTraceList||[];t.publishTraceList=n.map((function(t){return t.createTime=Object(m["c"])(t.createTime),""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t})),t.publishLocalTraceList=t.publishTraceList.filter((function(t){return t.type<4})),t.publishRemoteTraceList={};var r,o=d(t.publishTraceList);try{for(o.s();!(r=o.n()).done;){var i=r.value;i.type<4||(t.publishRemoteTraceList[i.serverName]||(t.publishRemoteTraceList[i.serverName]=[]),t.publishRemoteTraceList[i.serverName].push(i))}}catch(a){o.e(a)}finally{o.f()}t.activeRomoteTracePane=Object.keys(t.publishRemoteTraceList)[0]}))},handleDetail:function(t){var e=this;this.dialogVisible=!0,s(t.id).then((function(t){var n=t.data.gitTraceList||[];e.gitTraceList=n.map((function(t){return""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t.commit=t["commit"]?t["commit"].substring(0,6):"",t})),e.gitTraceList.length>0&&(e.publishToken=e.gitTraceList[0].token,e.getDetail())}))},handleDetailChange:function(t){this.publishToken=t,this.getDetail()},handlePublishCommand:function(t){var e=this,n=t.id;u(n).then((function(t){e.commitTableData=t.data.commitList.map((function(t){return Object.assign(t,{projectId:n})})),e.commitDialogVisible=!0}))},rollback:function(t){var e=this;this.$confirm("此操作将重新构建"+t.commit+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.connectWebSocket().then((function(n){f(t.projectId,t.commit).then((function(n){var r=e.tableData.findIndex((function(e){return e.id===t.projectId}));e.tableData[r].deployState=1,e.commitDialogVisible=!1}))}))})).catch((function(){e.$message({type:"info",message:"已取消重新构建"})}))},findGroupName:function(t){var e=this.groupOption.find((function(e){return e.id===t}));return e?e["name"]:"默认"},formatDetail:function(t){return t?t.replace(/\n|(\r\n)/g,"<br>"):""}}},g=h,y=(n("c1c1"),n("4023")),_=Object(y["a"])(g,r,o,!1,null,"08ca3d7f",null);e["default"]=_.exports},a08d:function(t,e,n){e.f=n("cb3d")},b99c:function(t,e,n){},c1c1:function(t,e,n){"use strict";var r=n("b99c"),o=n.n(r);o.a},e204:function(t,e,n){"use strict";var r=n("e46b"),o=n("013f")(6),i="findIndex",a=!0;i in[]&&Array(1)[i]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),n("0e8b")(i)},e697:function(t,e,n){"use strict";var r=n("e46b"),o=n("013f")(5),i="find",a=!0;i in[]&&Array(1)[i]((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),n("0e8b")(i)},ec25:function(t,e,n){"use strict";var r=n("4ce5"),o=n("e46b"),i=n("008a"),a=n("d0bc"),l=n("2285"),c=n("eafa"),s=n("ebc3"),u=n("f878");o(o.S+o.F*!n("d0c5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,o,f,p=i(t),m="function"==typeof this?this:Array,d=arguments.length,b=d>1?arguments[1]:void 0,v=void 0!==b,h=0,g=u(p);if(v&&(b=r(b,d>2?arguments[2]:void 0,2)),void 0==g||m==Array&&l(g))for(e=c(p.length),n=new m(e);e>h;h++)s(n,h,v?b(p[h],h):p[h]);else for(f=g.call(p),n=new m;!(o=f.next()).done;h++)s(n,h,v?a(f,b,[o.value,h],!0):o.value);return n.length=h,n}})},f091:function(t,e,n){var r=n("80a9"),o=n("2f77"),i=n("4f18");t.exports=function(t){var e=r(t),n=o.f;if(n){var a,l=n(t),c=i.f,s=0;while(l.length>s)c.call(t,a=l[s++])&&e.push(a)}return e}},f71f:function(t,e,n){var r=n("ec45")("meta"),o=n("fb68"),i=n("e042"),a=n("064e").f,l=0,c=Object.isExtensible||function(){return!0},s=!n("238a")((function(){return c(Object.preventExtensions({}))})),u=function(t){a(t,r,{value:{i:"O"+ ++l,w:{}}})},f=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!e)return"E";u(t)}return t[r].i},p=function(t,e){if(!i(t,r)){if(!c(t))return!0;if(!e)return!1;u(t)}return t[r].w},m=function(t){return s&&d.NEED&&c(t)&&!i(t,r)&&u(t),t},d=t.exports={KEY:r,NEED:!1,fastKey:f,getWeak:p,onFreeze:m}}}]);