(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b62fc"],{"1ba6":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"app-container"},[a("el-row",{staticClass:"app-bar",attrs:{type:"flex",justify:"end"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("添加")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"","highlight-current-row":"",data:t.tableData}},[a("el-table-column",{attrs:{prop:"name",label:"服务器"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP"}}),t._v(" "),a("el-table-column",{attrs:{prop:"port",label:"端口"}}),t._v(" "),a("el-table-column",{attrs:{prop:"owner",label:"sshKey所有者","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"group",label:"分组",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.findGroupName(e.row.groupId))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return t.handleRemove(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"服务器设置",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{rules:t.formRules,model:t.formData,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"服务器名称",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"IP",prop:"ip"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.ip,callback:function(e){t.$set(t.formData,"ip",e)},expression:"formData.ip"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"port",prop:"port"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.port,callback:function(e){t.$set(t.formData,"port",t._n(e))},expression:"formData.port"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"sshKey所有者",prop:"owner"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"root"},model:{value:t.formData.owner,callback:function(e){t.$set(t.formData,"owner",e)},expression:"formData.owner"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"绑定分组",prop:"groupId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择分组"},model:{value:t.formData.groupId,callback:function(e){t.$set(t.formData,"groupId",e)},expression:"formData.groupId"}},[a("el-option",{attrs:{label:"默认",value:0}}),t._v(" "),t._l(t.groupOption,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})})],2)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{disabled:t.formProps.disabled,type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},r=[],i=(a("7f7f"),a("7514"),a("ac6a"),a("aa22")),l=a("23ba"),s=a("ed08"),n={data:function(){return{dialogVisible:!1,tableData:[],groupOption:[],tempFormData:{},formProps:{disabled:!1},formData:{id:0,name:"",ip:"",port:22,owner:"",groupId:0},formRules:{name:[{required:!0,message:"请输入服务器名称",trigger:"blur"}],ip:[{required:!0,message:"请输入服务器ip",trigger:"blur"}],port:[{required:!0,message:"请输入服务器port",trigger:"blur"}],owner:[{required:!0,message:"请输入SSH-KEY的所有者",trigger:"blur"}]}}},created:function(){this.storeFormData(),this.getList(),this.getGroupOption()},methods:{getList:function(){var t=this;Object(i["c"])().then(function(e){var a=e.data.serverList||[];a.forEach(function(t){t.createTime=Object(s["a"])(t.createTime),t.updateTime=Object(s["a"])(t.updateTime)}),t.tableData=a})},getGroupOption:function(){var t=this;Object(l["d"])().then(function(e){t.groupOption=e.data.groupList||[]})},handleAdd:function(){this.restoreFormData(),this.dialogVisible=!0},handleEdit:function(t){this.formData=Object.assign({},t),this.dialogVisible=!0},handleRemove:function(t){var e=this;this.$confirm("此操作将删除该服务器, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i["e"])(t.id).then(function(t){e.$message({message:t.message,type:"success",duration:5e3}),e.getList()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},submit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;0===t.formData.id?t.add():t.edit()})},add:function(){var t=this;this.formProps.disabled=!0,Object(i["a"])(this.formData).then(function(e){t.getList(),t.$message({message:e.message,type:"success",duration:5e3})}).finally(function(){t.formProps.disabled=t.dialogVisible=!1})},edit:function(){var t=this;this.formProps.disabled=!0,Object(i["b"])(this.formData).then(function(e){t.getList(),t.$message({message:e.message,type:"success",duration:5e3})}).finally(function(){t.formProps.disabled=t.dialogVisible=!1})},findGroupName:function(t){var e=this.groupOption.find(function(e){return e.id===t});return e?e["name"]:"默认"},storeFormData:function(){this.tempFormData=JSON.parse(JSON.stringify(this.formData))},restoreFormData:function(){this.formData=JSON.parse(JSON.stringify(this.tempFormData))}}},u=n,p=a("2877"),c=Object(p["a"])(u,o,r,!1,null,null,null);e["default"]=c.exports}}]);