(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b8d40f4"],{"07b8":function(t,e,r){},"0a49":function(t,e,r){var n=r("9b43"),a=r("626a"),i=r("4bf8"),o=r("9def"),l=r("cd1c");t.exports=function(t,e){var r=1==t,s=2==t,c=3==t,u=4==t,p=6==t,f=5==t||p,m=e||l;return function(e,l,d){for(var g,b,h=i(e),v=a(h),_=n(l,d,3),y=o(v.length),w=0,S=r?m(e,y):s?m(e,0):void 0;y>w;w++)if((f||w in v)&&(g=v[w],b=_(g,w,h),t))if(r)S[w]=b;else if(b)switch(t){case 3:return!0;case 5:return g;case 6:return w;case 2:S.push(g)}else if(u)return!1;return p?-1:c||u?u:S}}},1169:function(t,e,r){var n=r("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"20d6":function(t,e,r){"use strict";var n=r("5ca1"),a=r("0a49")(6),i="findIndex",o=!0;i in[]&&Array(1)[i](function(){o=!1}),n(n.P+n.F*o,"Array",{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(i)},"23ba":function(t,e,r){"use strict";r.d(e,"d",function(){return i}),r.d(e,"e",function(){return o}),r.d(e,"c",function(){return l}),r.d(e,"a",function(){return s}),r.d(e,"b",function(){return c}),r.d(e,"f",function(){return u});var n=r("cebc"),a=r("b775");function i(t){return Object(a["a"])({url:"/group/getList",method:"get",params:Object(n["a"])({},t)})}function o(){return Object(a["a"])({url:"/group/getOption",method:"get"})}function l(){return Object(a["a"])({url:"/group/getDeployOption",method:"get"})}function s(t){return Object(a["a"])({url:"/group/add",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/group/edit",method:"post",data:t})}function u(t){return Object(a["a"])({url:"/group/remove",method:"delete",data:{id:t}})}},"37c8":function(t,e,r){e.f=r("2b4c")},"3a72":function(t,e,r){var n=r("7726"),a=r("8378"),i=r("2d00"),o=r("37c8"),l=r("86cc").f;t.exports=function(t){var e=a.Symbol||(a.Symbol=i?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||l(e,t,{value:o.f(t)})}},"431f":function(t,e,r){"use strict";var n=r("07b8"),a=r.n(n);a.a},"456d":function(t,e,r){var n=r("4bf8"),a=r("0d58");r("5eda")("keys",function(){return function(t){return a(n(t))}})},"5eda":function(t,e,r){var n=r("5ca1"),a=r("8378"),i=r("79e5");t.exports=function(t,e){var r=(a.Object||{})[t]||Object[t],o={};o[t]=e(r),n(n.S+n.F*i(function(){r(1)}),"Object",o)}},"67ab":function(t,e,r){var n=r("ca5a")("meta"),a=r("d3f4"),i=r("69a8"),o=r("86cc").f,l=0,s=Object.isExtensible||function(){return!0},c=!r("79e5")(function(){return s(Object.preventExtensions({}))}),u=function(t){o(t,n,{value:{i:"O"+ ++l,w:{}}})},p=function(t,e){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,n)){if(!s(t))return"F";if(!e)return"E";u(t)}return t[n].i},f=function(t,e){if(!i(t,n)){if(!s(t))return!0;if(!e)return!1;u(t)}return t[n].w},m=function(t){return c&&d.NEED&&s(t)&&!i(t,n)&&u(t),t},d=t.exports={KEY:n,NEED:!1,fastKey:p,getWeak:f,onFreeze:m}},7514:function(t,e,r){"use strict";var n=r("5ca1"),a=r("0a49")(5),i="find",o=!0;i in[]&&Array(1)[i](function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(i)},"7bbc":function(t,e,r){var n=r("6821"),a=r("9093").f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(t){try{return a(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==i.call(t)?l(t):a(n(t))}},"8a81":function(t,e,r){"use strict";var n=r("7726"),a=r("69a8"),i=r("9e1e"),o=r("5ca1"),l=r("2aba"),s=r("67ab").KEY,c=r("79e5"),u=r("5537"),p=r("7f20"),f=r("ca5a"),m=r("2b4c"),d=r("37c8"),g=r("3a72"),b=r("d4c0"),h=r("1169"),v=r("cb7c"),_=r("d3f4"),y=r("4bf8"),w=r("6821"),S=r("6a999"),T=r("4630"),x=r("2aeb"),D=r("7bbc"),O=r("11e9"),k=r("2621"),j=r("86cc"),L=r("0d58"),P=O.f,I=j.f,N=D.f,C=n.Symbol,E=n.JSON,H=E&&E.stringify,F="prototype",A=m("_hidden"),M=m("toPrimitive"),R={}.propertyIsEnumerable,V=u("symbol-registry"),$=u("symbols"),J=u("op-symbols"),G=Object[F],B="function"==typeof C&&!!k.f,W=n.QObject,K=!W||!W[F]||!W[F].findChild,Y=i&&c(function(){return 7!=x(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=P(G,e);n&&delete G[e],I(t,e,r),n&&t!==G&&I(G,e,n)}:I,z=function(t){var e=$[t]=x(C[F]);return e._k=t,e},Q=B&&"symbol"==typeof C.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof C},U=function(t,e,r){return t===G&&U(J,e,r),v(t),e=S(e,!0),v(r),a($,e)?(r.enumerable?(a(t,A)&&t[A][e]&&(t[A][e]=!1),r=x(r,{enumerable:T(0,!1)})):(a(t,A)||I(t,A,T(1,{})),t[A][e]=!0),Y(t,e,r)):I(t,e,r)},q=function(t,e){v(t);var r,n=b(e=w(e)),a=0,i=n.length;while(i>a)U(t,r=n[a++],e[r]);return t},X=function(t,e){return void 0===e?x(t):q(x(t),e)},Z=function(t){var e=R.call(this,t=S(t,!0));return!(this===G&&a($,t)&&!a(J,t))&&(!(e||!a(this,t)||!a($,t)||a(this,A)&&this[A][t])||e)},tt=function(t,e){if(t=w(t),e=S(e,!0),t!==G||!a($,e)||a(J,e)){var r=P(t,e);return!r||!a($,e)||a(t,A)&&t[A][e]||(r.enumerable=!0),r}},et=function(t){var e,r=N(w(t)),n=[],i=0;while(r.length>i)a($,e=r[i++])||e==A||e==s||n.push(e);return n},rt=function(t){var e,r=t===G,n=N(r?J:w(t)),i=[],o=0;while(n.length>o)!a($,e=n[o++])||r&&!a(G,e)||i.push($[e]);return i};B||(C=function(){if(this instanceof C)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(r){this===G&&e.call(J,r),a(this,A)&&a(this[A],t)&&(this[A][t]=!1),Y(this,t,T(1,r))};return i&&K&&Y(G,t,{configurable:!0,set:e}),z(t)},l(C[F],"toString",function(){return this._k}),O.f=tt,j.f=U,r("9093").f=D.f=et,r("52a7").f=Z,k.f=rt,i&&!r("2d00")&&l(G,"propertyIsEnumerable",Z,!0),d.f=function(t){return z(m(t))}),o(o.G+o.W+o.F*!B,{Symbol:C});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),at=0;nt.length>at;)m(nt[at++]);for(var it=L(m.store),ot=0;it.length>ot;)g(it[ot++]);o(o.S+o.F*!B,"Symbol",{for:function(t){return a(V,t+="")?V[t]:V[t]=C(t)},keyFor:function(t){if(!Q(t))throw TypeError(t+" is not a symbol!");for(var e in V)if(V[e]===t)return e},useSetter:function(){K=!0},useSimple:function(){K=!1}}),o(o.S+o.F*!B,"Object",{create:X,defineProperty:U,defineProperties:q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:rt});var lt=c(function(){k.f(1)});o(o.S+o.F*lt,"Object",{getOwnPropertySymbols:function(t){return k.f(y(t))}}),E&&o(o.S+o.F*(!B||c(function(){var t=C();return"[null]"!=H([t])||"{}"!=H({a:t})||"{}"!=H(Object(t))})),"JSON",{stringify:function(t){var e,r,n=[t],a=1;while(arguments.length>a)n.push(arguments[a++]);if(r=e=n[1],(_(e)||void 0!==t)&&!Q(t))return h(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Q(e))return e}),n[1]=e,H.apply(E,n)}}),C[F][M]||r("32e9")(C[F],M,C[F].valueOf),p(C,"Symbol"),p(Math,"Math",!0),p(n.JSON,"JSON",!0)},"9b7a":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-row",{staticClass:"app-container"},[r("el-row",{staticClass:"app-bar",attrs:{type:"flex"}},[r("el-select",{attrs:{placeholder:"选择分组"},on:{change:t.handleGroupChange},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},[r("el-option",{attrs:{label:"默认",value:0}}),t._v(" "),t._l(t.groupOption,function(t,e){return r("el-option",{key:e,attrs:{label:t.name,value:t.id}})})],2),t._v(" "),r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入项目名称"},on:{change:t.getList},model:{value:t.projectName,callback:function(e){t.projectName=e},expression:"projectName"}})],1),t._v(" "),r("el-table",{key:t.tableHeight,staticStyle:{width:"100%","margin-top":"5px"},attrs:{border:"",stripe:"","highlight-current-row":"","max-height":t.tableHeight,data:t.tableData}},[r("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"name",label:"项目名称","min-width":"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["生产环境"===e.row.environment?r("b",{staticStyle:{color:"#F56C6C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):"测试环境"===e.row.environment?r("b",{staticStyle:{color:"#E6A23C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):r("b",{staticStyle:{color:"#909399"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"group",label:"分组",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.findGroupName(e.row.groupId))+"\n      ")]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"branch",label:"分支",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"deployState",label:"构建状态",width:"230",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tag",{attrs:{type:e.row.tagType,effect:"plain"}},[t._v(t._s(e.row.tagText))]),t._v(" "),r("el-progress",{attrs:{percentage:e.row.progressPercentage,status:e.row.progressStatus}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"updateTime",label:"上次构建时间",width:"160",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"operation",label:"操作",width:"165",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-row",{staticClass:"operation-btn"},[r("el-dropdown",{attrs:{"split-button":"",trigger:"click",disabled:1===e.row.deployState,type:"primary"},on:{click:function(r){return t.publish(e.row)},command:t.handlePublishCommand}},[t._v("\n            构建\n            "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:e.row}},[t._v("选择具体commit")])],1)],1),t._v(" "),r("el-button",{attrs:{type:"success"},on:{click:function(r){return t.handleDetail(e.row)}}},[t._v("详情")])],1)]}}])})],1),t._v(" "),r("el-dialog",{staticClass:"publish-record",attrs:{title:"构建记录",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-radio-group",{on:{change:t.handleDetailChange},model:{value:t.publishToken,callback:function(e){t.publishToken=e},expression:"publishToken"}},t._l(t.gitTraceList,function(e,n){return r("el-row",{key:n},[r("el-row",{staticStyle:{margin:"5px 0"}},[r("el-radio",{staticStyle:{"margin-left":"10px","margin-right":"5px","padding-right":"8px",width:"210px"},attrs:{label:e.token,border:""}},[t._v("\n                "+t._s(e.publisherName)+" commitID: "+t._s(e.commit)+"\n                "),1===e.publishState?r("span",{staticStyle:{color:"#67C23A",float:"right","line-height":"16px"}},[t._v("成功")]):r("span",{staticStyle:{color:"#F56C6C",float:"right","line-height":"16px"}},[t._v("失败")])]),t._v(" "),r("el-button",{attrs:{type:"danger",plain:""},on:{click:function(r){return t.rollback(e)}}},[t._v("rebuild")])],1)],1)}),1)],1),t._v(" "),r("el-col",{staticClass:"project-detail",attrs:{span:16}},[t._l(t.publishLocalTraceList,function(e,n){return r("el-row",{key:n},[2===e.type?r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("git同步信息")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),0!==e.state?r("el-row",[r("el-row",[t._v("commit: "+t._s(e["commit"]))]),t._v(" "),r("el-row",[t._v("message: "+t._s(e["message"]))]),t._v(" "),r("el-row",[t._v("author: "+t._s(e["author"]))]),t._v(" "),r("el-row",[t._v("datetime: "+t._s(e["timestamp"]?t.parseTime(e["timestamp"]):""))]),t._v(" "),r("el-row",[r("span",{domProps:{innerHTML:t._s(t.formatDetail(e["diff"]))}})])],1):r("el-row",{staticStyle:{margin:"5px 0"}},[r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]),t._v(" "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):t._e(),t._v(" "),3===e.type?r("el-row",[r("hr"),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("获取代码后脚本信息")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("脚本: "),r("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("el-row",[t._v("[goploy ~]# "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):t._e(),t._v(" "),6===e.type?r("el-row",[r("hr"),t._v(" "),r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("remote服务器信息")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("服务器: "+t._s(e.serverName))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("脚本: "+t._s(e.script))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1)],1):t._e()],1)}),t._v(" "),r("hr"),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("目标服务器")]),t._v(" "),r("el-tabs",{model:{value:t.activeRomoteTracePane,callback:function(e){t.activeRomoteTracePane=e},expression:"activeRomoteTracePane"}},t._l(t.publishRemoteTraceList,function(e,n){return r("el-tab-pane",{key:n,attrs:{label:n,name:n}},t._l(e,function(e,n){return r("el-row",{key:n},[4===e.type?r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署前脚本")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("脚本: "),r("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("el-row",[t._v("[goploy ~]# "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):5===e.type?r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("rsync同步文件")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("命令: "+t._s(e.command))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署后脚本")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("脚本: "+t._s(e.script))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("el-row",[t._v("[goploy ~]# "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1)],1)}),1)}),1)],2)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1),t._v(" "),r("el-dialog",{attrs:{title:"commit管理",visible:t.commitDialogVisible},on:{"update:visible":function(e){t.commitDialogVisible=e}}},[r("el-table",{attrs:{border:"",stripe:"","highlight-current-row":"","max-height":"447px",data:t.commitTableData}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.row.diff))}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"commit",label:"commit",width:"290"}}),t._v(" "),r("el-table-column",{attrs:{prop:"author",label:"author"}}),t._v(" "),r("el-table-column",{attrs:{label:"提交时间",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.parseTime(e.row.timestamp))+"\n        ")]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"message",label:"message",width:"200","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"operation",label:"操作",width:"80",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"danger"},on:{click:function(r){return t.rollback(e.row)}}},[t._v("构建")])]}}])})],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.commitDialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},a=[],i=(r("a481"),r("7514"),r("ac4d"),r("8a81"),r("ac6a"),r("456d"),r("7f7f"),r("20d6"),{data:function(){return{tableHeight:window.innerHeight-160}},mounted:function(){try{var t=document.getElementsByClassName("app-bar")[0].clientHeight+140,e=window.innerHeight-t;this.tableHeight=e}catch(r){console.log("缺少节点app-bar")}}}),o=r("b775");function l(t,e){return Object(o["a"])({url:"/deploy/getList",method:"get",params:{groupId:t,projectName:e}})}function s(t){return Object(o["a"])({url:"/deploy/getDetail",method:"get",params:{lastPublishToken:t}})}function c(t){return Object(o["a"])({url:"/deploy/getPreview",method:"get",params:{projectId:t}})}function u(t){return Object(o["a"])({url:"/deploy/getCommitList",method:"get",params:{id:t}})}function p(t,e){return Object(o["a"])({url:"/deploy/publish",method:"post",data:{projectId:t,commit:e}})}var f=r("23ba"),m=r("ed08"),d={mixins:[i],data:function(){return{groupId:parseInt(localStorage.getItem("groupId"))||0,groupOption:[],projectName:"",publishToken:"",commitDialogVisible:!1,dialogVisible:!1,webSocket:null,tableData:[],commitTableData:[],gitTraceList:[],publishTraceList:[],publishLocalTraceList:[],publishRemoteTraceList:{},activeRomoteTracePane:""}},watch:{"$store.getters.ws_message":function(t){if(1===t.type){var e=t.message;e.message=this.formatDetail(e.message),0===e.state&&this.$notify.error({title:e.projectName,dangerouslyUseHTMLString:!0,message:e.message,duration:0});var r=this.tableData.findIndex(function(t){return t.id===e.projectId});if(-1!==r){var n=12.5*e.state;this.tableData[r].progressPercentage=n,this.tableData[r].progressStatus="warning",this.tableData[r].tagType="warning",this.tableData[r].tagText=e.message,0===n?(this.tableData[r].progressStatus="exception",this.tableData[r].tagType="danger",this.tableData[r].tagText="失败"):n>98&&(this.tableData[r].progressStatus="success",this.tableData[r].tagType="success"),this.tableData[r].deployState=e.state,this.tableData[r].publisherName=e.username,this.tableData[r].updateTime=Object(m["c"])(new Date)}}}},created:function(){var t=this;this.getList(),this.getDeployGroupOption(),this.$router.afterEach(function(){t.webSocket&&t.webSocket.close()})},methods:{parseTime:m["c"],handleGroupChange:function(t){localStorage.setItem("groupId",t),this.groupId=t,this.getList()},getDeployGroupOption:function(){var t=this;Object(f["c"])().then(function(e){t.groupOption=e.data.groupList||[]})},getList:function(){var t=this;l(this.groupId,this.projectName).then(function(e){var r=e.data.projectList||[];t.tableData=r.map(function(t){return t.progressPercentage=0,t.tagType="info",t.tagText="未构建",2===t.deployState?(t.progressPercentage=100,t.progressStatus="success",t.tagType="success",t.tagText="成功"):1===t.deployState&&(t.progressPercentage=60,t.progressStatus="warning",t.tagType="warning",t.tagText="构建中"),t})})},publish:function(t){var e=this,r=t.id,n=this.$createElement,a="";a="生产环境"===t.environment?"color: #F56C6C":"测试环境"===t.environment?"color: #E6A23C":"color: #909399",this.$confirm("","提示",{message:n("p",null,[n("span",null,"此操作将部署 "+t.name),n("b",{style:a},"("+t.environment+")"),n("span",null,", 是否继续? ")]),confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.gitLog=[],e.remoteLog={},p(r,"").then(function(t){var n=e.tableData.findIndex(function(t){return t.id===r});e.tableData[n].deployState=1})}).catch(function(){e.$message({type:"info",message:"已取消构建"})})},getDetail:function(){var t=this;s(this.publishToken).then(function(e){var r=e.data.publishTraceList||[];t.publishTraceList=r.map(function(t){return""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t}),t.publishLocalTraceList=t.publishTraceList.filter(function(t){return t.type<4}),t.publishRemoteTraceList={};var n=!0,a=!1,i=void 0;try{for(var o,l=t.publishTraceList[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var s=o.value;s.type<4||(t.publishRemoteTraceList[s.serverName]||(t.publishRemoteTraceList[s.serverName]=[]),t.publishRemoteTraceList[s.serverName].push(s))}}catch(c){a=!0,i=c}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}t.activeRomoteTracePane=Object.keys(t.publishRemoteTraceList)[0]})},handleDetail:function(t){var e=this;this.dialogVisible=!0,c(t.id).then(function(t){var r=t.data.gitTraceList||[];e.gitTraceList=r.map(function(t){return""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t.commit=t["commit"]?t["commit"].substring(0,6):"",t}),e.gitTraceList.length>0&&(e.publishToken=e.gitTraceList[0].token,e.getDetail())})},handleDetailChange:function(t){this.publishToken=t,this.getDetail()},handlePublishCommand:function(t){var e=this,r=t.id;u(r).then(function(t){e.commitTableData=t.data.commitList.map(function(t){return Object.assign(t,{projectId:r})}),e.commitDialogVisible=!0})},rollback:function(t){var e=this;this.$confirm("此操作将重新构建"+t.commit+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.connectWebSocket().then(function(r){p(t.projectId,t.commit).then(function(r){var n=e.tableData.findIndex(function(e){return e.id===t.projectId});e.tableData[n].deployState=1,e.commitDialogVisible=!1})})}).catch(function(){e.$message({type:"info",message:"已取消重新构建"})})},findGroupName:function(t){var e=this.groupOption.find(function(e){return e.id===t});return e?e["name"]:"默认"},formatDetail:function(t){return t?t.replace(/\n|(\r\n)/g,"<br>"):""}}},g=d,b=(r("431f"),r("2877")),h=Object(b["a"])(g,n,a,!1,null,"2d3fa718",null);e["default"]=h.exports},ac4d:function(t,e,r){r("3a72")("asyncIterator")},cd1c:function(t,e,r){var n=r("e853");t.exports=function(t,e){return new(n(t))(e)}},d4c0:function(t,e,r){var n=r("0d58"),a=r("2621"),i=r("52a7");t.exports=function(t){var e=n(t),r=a.f;if(r){var o,l=r(t),s=i.f,c=0;while(l.length>c)s.call(t,o=l[c++])&&e.push(o)}return e}},e853:function(t,e,r){var n=r("d3f4"),a=r("1169"),i=r("2b4c")("species");t.exports=function(t){var e;return a(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!a(e.prototype)||(e=void 0),n(e)&&(e=e[i],null===e&&(e=void 0))),void 0===e?Array:e}}}]);