(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f3234a44"],{1239:function(e,t,r){"use strict";var a=r("4f23"),i=r.n(a);i.a},"4f23":function(e,t,r){},"836f":function(e,t,r){},9751:function(e,t,r){"use strict";var a=r("836f"),i=r.n(a);i.a},cc5e:function(e,t,r){"use strict";r.d(t,"c",function(){return i}),r.d(t,"d",function(){return o}),r.d(t,"a",function(){return s}),r.d(t,"b",function(){return n});var a=r("b775");function i(e){return Object(a["a"])({url:"/role/getOption",method:"get",params:e})}function o(){return Object(a["a"])({url:"/role/getPermissionList",method:"get"})}function s(e,t,r){return Object(a["a"])({url:"/role/add",method:"post",data:{name:e,remark:t,permissionList:r}})}function n(e,t,r,i){return Object(a["a"])({url:"/role/edit",method:"post",data:{id:e,name:t,remark:r,permissionList:i}})}},e890:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{ref:"form",attrs:{model:e.formData,rules:e.formRules,"validate-on-rule-change":!1,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[r("el-radio-group",{on:{change:e.handleRoleChange},model:{value:e.formData.roleId,callback:function(t){e.$set(e.formData,"roleId",t)},expression:"formData.roleId"}},[e._l(e.roleList,function(t){return r("el-radio",{directives:[{name:"show",rawName:"v-show",value:1!==t.id,expression:"role.id !== 1"}],key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])}),e._v(" "),r("el-radio",{attrs:{label:0}},[e._v("新增")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{staticStyle:{width:"250px"},attrs:{autocomplete:"off"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"描述",prop:"remark"}},[r("el-input",{staticStyle:{width:"250px"},attrs:{rows:3,type:"textarea",autocomplete:"off"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限",prop:"permissionList"}},e._l(e.permissionTree,function(t,a){return r("el-row",{key:a},[r("el-row",[e._v(e._s(t.title))]),e._v(" "),r("el-row",{staticStyle:{"margin-left":"10px"}},e._l(t.children,function(t,a){return r("el-checkbox",{key:a,attrs:{label:t},model:{value:e.formData.permissionList,callback:function(t){e.$set(e.formData,"permissionList",t)},expression:"formData.permissionList"}},[e._v("\n            "+e._s(t.title)+"\n          ")])}),1)],1)}),1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{disabled:e.formProps.disabled,type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},i=[],o=(r("4f7f"),r("5df3"),r("1c4c"),r("55dd"),r("ac6a"),r("28a5"),r("7f7f"),r("7514"),r("cc5e")),s={name:"Permission",data:function(){return{roleList:[],permissionTree:[],formProps:{disabled:!1},formData:{roleId:2,name:"",remark:"",permissionList:[]},formRules:{roleId:[{required:!0,message:"请选择所需要更新权限的角色",trigger:"blur"}],name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],permissionList:[{required:!0,type:"array",message:"请选择所需要更新的权限",trigger:"blur"}]}}},created:function(){this.getPermissionList()},methods:{handleRoleChange:function(e){var t=this;if(0===e)return this.formData.name="",this.formData.remark="",void(this.formData.permissionList=[]);var r=this.roleList.find(function(t){return t.id===e});this.formData.name=r["name"],this.formData.remark=r["remark"];var a=r["permissionList"].split(",").map(function(e){return parseInt(e)});this.formData.permissionList=[],0!==a.length&&this.permissionTree.forEach(function(e){e.children.forEach(function(e){var r=a.indexOf(e.id);-1!==r&&t.formData.permissionList.push(e)})})},submit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;var r=[];e.formData.permissionList.forEach(function(e){r.push(e.id,e.pid)});var a=Array.from(new Set(r)).sort(function(e,t){return e-t}).join(",");e.formProps.disabled=!0,0===e.formData.roleId?e.add(a):e.edit(a)})},add:function(e){var t=this;Object(o["a"])(this.formData.name,this.formData.remark,e).then(function(e){t.getPermissionList(),t.$message({message:e.message,type:"success",duration:5e3})}).finally(function(e){t.formProps.disabled=!1})},edit:function(e){var t=this;Object(o["b"])(this.formData.roleId,this.formData.name,this.formData.remark,e).then(function(e){t.getPermissionList(),t.$message({message:e.message,type:"success",duration:5e3})}).finally(function(e){t.formProps.disabled=!1})},getPermissionList:function(){var e=this;Object(o["d"])().then(function(t){var r=t.data;e.permissionTree=r.permissionTree,e.roleList=r.roleList,e.handleRoleChange(e.formData.roleId)})}}},n=s,m=(r("9751"),r("1239"),r("2877")),l=Object(m["a"])(n,a,i,!1,null,"f0572b04",null);t["default"]=l.exports}}]);