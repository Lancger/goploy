(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49173c8a"],{"013f":function(t,e,r){var n=r("4ce5"),a=r("224c"),i=r("008a"),o=r("eafa"),s=r("5dd2");t.exports=function(t,e){var r=1==t,l=2==t,c=3==t,u=4==t,p=6==t,f=5==t||p,g=e||s;return function(e,s,d){for(var h,m,v=i(e),b=a(v),y=n(s,d,3),w=o(b.length),_=0,S=r?g(e,w):l?g(e,0):void 0;w>_;_++)if((f||_ in b)&&(h=b[_],m=y(h,_,v),t))if(r)S[_]=m;else if(m)switch(t){case 3:return!0;case 5:return h;case 6:return _;case 2:S.push(h)}else if(u)return!1;return p?-1:c||u?u:S}}},"06a2":function(t,e,r){"use strict";var n=r("fc81")(!0);r("492d")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})}))},"0b53":function(t,e,r){"use strict";var n=r("e7ad"),a=r("e042"),i=r("149f"),o=r("e46b"),s=r("bf16"),l=r("f71f").KEY,c=r("238a"),u=r("6798"),p=r("399f"),f=r("ec45"),g=r("cb3d"),d=r("a08d"),h=r("4d34"),m=r("f091"),v=r("2346"),b=r("69b3"),y=r("fb68"),w=r("008a"),_=r("09b9"),S=r("94b3"),P=r("cc33"),O=r("e005"),x=r("9370"),T=r("dcb7"),j=r("2f77"),D=r("064e"),L=r("80a9"),k=T.f,I=D.f,C=x.f,N=n.Symbol,A=n.JSON,E=A&&A.stringify,H="prototype",$=g("_hidden"),F=g("toPrimitive"),M={}.propertyIsEnumerable,R=u("symbol-registry"),V=u("symbols"),z=u("op-symbols"),J=Object[H],G="function"==typeof N&&!!j.f,B=n.QObject,U=!B||!B[H]||!B[H].findChild,K=i&&c((function(){return 7!=O(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a}))?function(t,e,r){var n=k(J,e);n&&delete J[e],I(t,e,r),n&&t!==J&&I(J,e,n)}:I,W=function(t){var e=V[t]=O(N[H]);return e._k=t,e},Y=G&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Q=function(t,e,r){return t===J&&Q(z,e,r),b(t),e=S(e,!0),b(r),a(V,e)?(r.enumerable?(a(t,$)&&t[$][e]&&(t[$][e]=!1),r=O(r,{enumerable:P(0,!1)})):(a(t,$)||I(t,$,P(1,{})),t[$][e]=!0),K(t,e,r)):I(t,e,r)},q=function(t,e){b(t);var r,n=m(e=_(e)),a=0,i=n.length;while(i>a)Q(t,r=n[a++],e[r]);return t},X=function(t,e){return void 0===e?O(t):q(O(t),e)},Z=function(t){var e=M.call(this,t=S(t,!0));return!(this===J&&a(V,t)&&!a(z,t))&&(!(e||!a(this,t)||!a(V,t)||a(this,$)&&this[$][t])||e)},tt=function(t,e){if(t=_(t),e=S(e,!0),t!==J||!a(V,e)||a(z,e)){var r=k(t,e);return!r||!a(V,e)||a(t,$)&&t[$][e]||(r.enumerable=!0),r}},et=function(t){var e,r=C(_(t)),n=[],i=0;while(r.length>i)a(V,e=r[i++])||e==$||e==l||n.push(e);return n},rt=function(t){var e,r=t===J,n=C(r?z:_(t)),i=[],o=0;while(n.length>o)!a(V,e=n[o++])||r&&!a(J,e)||i.push(V[e]);return i};G||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(r){this===J&&e.call(z,r),a(this,$)&&a(this[$],t)&&(this[$][t]=!1),K(this,t,P(1,r))};return i&&U&&K(J,t,{configurable:!0,set:e}),W(t)},s(N[H],"toString",(function(){return this._k})),T.f=tt,D.f=Q,r("2ea2").f=x.f=et,r("4f18").f=Z,j.f=rt,i&&!r("550e")&&s(J,"propertyIsEnumerable",Z,!0),d.f=function(t){return W(g(t))}),o(o.G+o.W+o.F*!G,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),at=0;nt.length>at;)g(nt[at++]);for(var it=L(g.store),ot=0;it.length>ot;)h(it[ot++]);o(o.S+o.F*!G,"Symbol",{for:function(t){return a(R,t+="")?R[t]:R[t]=N(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in R)if(R[e]===t)return e},useSetter:function(){U=!0},useSimple:function(){U=!1}}),o(o.S+o.F*!G,"Object",{create:X,defineProperty:Q,defineProperties:q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:rt});var st=c((function(){j.f(1)}));o(o.S+o.F*st,"Object",{getOwnPropertySymbols:function(t){return j.f(w(t))}}),A&&o(o.S+o.F*(!G||c((function(){var t=N();return"[null]"!=E([t])||"{}"!=E({a:t})||"{}"!=E(Object(t))}))),"JSON",{stringify:function(t){var e,r,n=[t],a=1;while(arguments.length>a)n.push(arguments[a++]);if(r=e=n[1],(y(e)||void 0!==t)&&!Y(t))return v(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Y(e))return e}),n[1]=e,E.apply(A,n)}}),N[H][F]||r("86d4")(N[H],F,N[H].valueOf),p(N,"Symbol"),p(Math,"Math",!0),p(n.JSON,"JSON",!0)},2346:function(t,e,r){var n=r("75c4");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"23ba":function(t,e,r){"use strict";r.d(e,"d",(function(){return s})),r.d(e,"e",(function(){return l})),r.d(e,"c",(function(){return c})),r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return p})),r.d(e,"f",(function(){return f}));r("5ab2"),r("6d57"),r("e10e");var n=r("70ea"),a=r("b775");function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){Object(n["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t){return Object(a["a"])({url:"/group/getList",method:"get",params:o({},t)})}function l(){return Object(a["a"])({url:"/group/getOption",method:"get"})}function c(){return Object(a["a"])({url:"/group/getDeployOption",method:"get"})}function u(t){return Object(a["a"])({url:"/group/add",method:"post",data:t})}function p(t){return Object(a["a"])({url:"/group/edit",method:"post",data:t})}function f(t){return Object(a["a"])({url:"/group/remove",method:"delete",data:{id:t}})}},"309f":function(t,e,r){r("4d34")("asyncIterator")},"4d34":function(t,e,r){var n=r("e7ad"),a=r("7ddc"),i=r("550e"),o=r("a08d"),s=r("064e").f;t.exports=function(t){var e=a.Symbol||(a.Symbol=i?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:o.f(t)})}},"52aa":function(t,e,r){},"5dd2":function(t,e,r){var n=r("81dc");t.exports=function(t,e){return new(n(t))(e)}},"81dc":function(t,e,r){var n=r("fb68"),a=r("2346"),i=r("cb3d")("species");t.exports=function(t){var e;return a(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!a(e.prototype)||(e=void 0),n(e)&&(e=e[i],null===e&&(e=void 0))),void 0===e?Array:e}},9370:function(t,e,r){var n=r("09b9"),a=r("2ea2").f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return a(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==i.call(t)?s(t):a(n(t))}},"9b7a":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-row",{staticClass:"app-container"},[r("el-row",{staticClass:"app-bar",attrs:{type:"flex"}},[r("el-select",{attrs:{placeholder:"选择分组"},on:{change:t.handleGroupChange},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},[r("el-option",{attrs:{label:"默认",value:0}}),t._v(" "),t._l(t.groupOption,(function(t,e){return r("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],2),t._v(" "),r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入项目名称"},on:{change:t.getList},model:{value:t.projectName,callback:function(e){t.projectName=e},expression:"projectName"}})],1),t._v(" "),r("el-table",{key:t.tableHeight,staticStyle:{width:"100%","margin-top":"5px"},attrs:{border:"",stripe:"","highlight-current-row":"","max-height":t.tableHeight,data:t.tablePageData}},[r("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"name",label:"项目名称","min-width":"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["生产环境"===e.row.environment?r("b",{staticStyle:{color:"#F56C6C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):"测试环境"===e.row.environment?r("b",{staticStyle:{color:"#E6A23C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):r("b",{staticStyle:{color:"#909399"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"group",label:"分组",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.findGroupName(e.row.groupId))+"\n      ")]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"branch",label:"分支",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"deployState",label:"构建状态",width:"230",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tag",{attrs:{type:e.row.tagType,effect:"plain"}},[t._v(t._s(e.row.tagText))]),t._v(" "),r("el-progress",{attrs:{percentage:e.row.progressPercentage,status:e.row.progressStatus}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"updateTime",label:"上次构建时间",width:"160",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"operation",label:"操作",width:"165",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-row",{staticClass:"operation-btn"},[r("el-dropdown",{attrs:{"split-button":"",trigger:"click",disabled:1===e.row.deployState,type:"primary"},on:{click:function(r){return t.publish(e.row)},command:t.handlePublishCommand}},[t._v("\n            构建\n            "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:e.row}},[t._v("选择具体commit")])],1)],1),t._v(" "),r("el-button",{attrs:{type:"success"},on:{click:function(r){return t.handleDetail(e.row)}}},[t._v("详情")])],1)]}}])})],1),t._v(" "),r("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{total:t.pagination.total,"page-size":t.pagination.rows,"current-page":t.pagination.page,background:"","page-sizes":[20,50,100],layout:"sizes, total, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.pagination,"page",e)},"update:current-page":function(e){return t.$set(t.pagination,"page",e)},"size-change":t.handleSizeChange,"current-change":t.handlePageChange}}),t._v(" "),r("el-dialog",{staticClass:"publish-record",attrs:{title:"构建记录",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("el-row",{attrs:{type:"flex"}},[r("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.searchPreview.loading,expression:"searchPreview.loading"}],staticClass:"publish-preview"},[r("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"选择用户",clearable:""},model:{value:t.searchPreview.userId,callback:function(e){t.$set(t.searchPreview,"userId",e)},expression:"searchPreview.userId"}},t._l(t.userOption,(function(t,e){return r("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1),t._v(" "),r("el-select",{staticStyle:{width:"85px"},attrs:{placeholder:"状态",clearable:""},model:{value:t.searchPreview.state,callback:function(e){t.$set(t.searchPreview,"state",e)},expression:"searchPreview.state"}},[r("el-option",{attrs:{label:"成功",value:1}}),t._v(" "),r("el-option",{attrs:{label:"失败",value:0}})],1),t._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchPreviewList}},[t._v("搜索")]),t._v(" "),r("el-radio-group",{on:{change:t.handleDetailChange},model:{value:t.publishToken,callback:function(e){t.publishToken=e},expression:"publishToken"}},t._l(t.gitTraceList,(function(e,n){return r("el-row",{key:n},[r("el-row",{staticStyle:{margin:"5px 0"}},[r("el-radio",{staticStyle:{"margin-right":"5px","padding-right":"8px",width:"210px"},attrs:{label:e.token,border:""}},[t._v("\n                "+t._s(e.publisherName)+" commitID: "+t._s(e.commit)+"\n                "),1===e.publishState?r("span",{staticStyle:{color:"#67C23A",float:"right","line-height":"16px"}},[t._v("成功")]):r("span",{staticStyle:{color:"#F56C6C",float:"right","line-height":"16px"}},[t._v("失败")])]),t._v(" "),r("el-button",{attrs:{type:"danger",plain:""},on:{click:function(r){return t.rollback(e)}}},[t._v("rebuild")])],1)],1)})),1),t._v(" "),r("el-pagination",{staticStyle:{"text-align":"right","margin-right":"20px"},attrs:{total:t.previewPagination.total,"page-size":t.previewPagination.rows,"current-page":t.previewPagination.page,"prev-text":"上一页","next-text":"下一页",layout:"total, prev, next"},on:{"update:currentPage":function(e){return t.$set(t.previewPagination,"page",e)},"update:current-page":function(e){return t.$set(t.previewPagination,"page",e)},"current-change":t.handlePreviewPageChange}})],1),t._v(" "),r("el-row",{staticClass:"project-detail",staticStyle:{flex:"1",width:"100%"}},[t._l(t.publishLocalTraceList,(function(e,n){return r("el-row",{key:n},[2===e.type?r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("git同步信息")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),0!==e.state?r("el-row",[r("el-row",[t._v("commit: "+t._s(e["commit"]))]),t._v(" "),r("el-row",[t._v("message: "+t._s(e["message"]))]),t._v(" "),r("el-row",[t._v("author: "+t._s(e["author"]))]),t._v(" "),r("el-row",[t._v("datetime: "+t._s(e["timestamp"]?t.parseTime(e["timestamp"]):""))]),t._v(" "),r("el-row",[r("span",{domProps:{innerHTML:t._s(t.formatDetail(e["diff"]))}})])],1):r("el-row",{staticStyle:{margin:"5px 0"}},[r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]),t._v(" "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):t._e(),t._v(" "),3===e.type?r("el-row",[r("hr"),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("获取代码后脚本信息")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("脚本: "),r("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("el-row",[t._v("[goploy ~]# "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):t._e(),t._v(" "),6===e.type?r("el-row",[r("hr"),t._v(" "),r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("remote服务器信息")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("服务器: "+t._s(e.serverName))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("脚本: "+t._s(e.script))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1)],1):t._e()],1)})),t._v(" "),r("hr"),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("目标服务器")]),t._v(" "),r("el-tabs",{model:{value:t.activeRomoteTracePane,callback:function(e){t.activeRomoteTracePane=e},expression:"activeRomoteTracePane"}},t._l(t.publishRemoteTraceList,(function(e,n){return r("el-tab-pane",{key:n,attrs:{label:n,name:n}},t._l(e,(function(e,n){return r("el-row",{key:n},[4===e.type?r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署前脚本")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("脚本: "),r("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("el-row",[t._v("[goploy ~]# "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):5===e.type?r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("rsync同步文件")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("命令: "+t._s(e.command))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):r("el-row",[r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署后脚本")]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.insertTime))]),t._v(" "),r("el-row",[t._v("脚本: "+t._s(e.script))]),t._v(" "),r("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?r("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),r("el-row",[t._v("[goploy ~]# "),r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1)],1)})),1)})),1)],2)],1)],1),t._v(" "),r("el-dialog",{attrs:{title:"commit管理",visible:t.commitDialogVisible},on:{"update:visible":function(e){t.commitDialogVisible=e}}},[r("el-table",{attrs:{border:"",stripe:"","highlight-current-row":"","max-height":"447px",data:t.commitTableData}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{domProps:{innerHTML:t._s(t.formatDetail(e.row.diff))}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"commit",label:"commit",width:"290"}}),t._v(" "),r("el-table-column",{attrs:{prop:"author",label:"author"}}),t._v(" "),r("el-table-column",{attrs:{label:"提交时间",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.parseTime(e.row.timestamp))+"\n        ")]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"message",label:"message",width:"200","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"operation",label:"操作",width:"80",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"danger"},on:{click:function(r){return t.rollback(e.row)}}},[t._v("构建")])]}}])})],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.commitDialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},a=[],i=(r("309f"),r("0b53"),r("06a2"),r("ec25"),r("2b45"),r("f548"),r("e697"),r("6d57"),r("e10e"),r("cc57"),r("e204"),r("9cea")),o=(r("5ab2"),r("70ea")),s=r("b775");function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e){return Object(s["a"])({url:"/deploy/getList",method:"get",params:{groupId:t,projectName:e}})}function p(t){return Object(s["a"])({url:"/deploy/getDetail",method:"get",params:{lastPublishToken:t}})}function f(t,e){var r=t.page,n=t.rows;return Object(s["a"])({url:"/deploy/getPreview",method:"get",params:c({page:r,rows:n},e)})}function g(t){return Object(s["a"])({url:"/deploy/getCommitList",method:"get",params:{id:t}})}function d(t,e){return Object(s["a"])({url:"/deploy/publish",method:"post",data:{projectId:t,commit:e}})}var h=r("23ba"),m=r("c24f"),v=r("ed08");function b(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=y(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function y(t,e){if(t){if("string"===typeof t)return w(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var _={mixins:[i["a"]],data:function(){return{groupId:parseInt(localStorage.getItem("groupId"))||0,userId:"",groupOption:[],userOption:[],projectName:"",publishToken:"",commitDialogVisible:!1,dialogVisible:!1,tableData:[],pagination:{total:0,page:1,rows:20},searchPreview:{loading:!1,projectId:"",userId:"",state:""},gitTraceList:[],previewPagination:{page:1,rows:11,total:0},commitTableData:[],publishTraceList:[],publishLocalTraceList:[],publishRemoteTraceList:{},activeRomoteTracePane:""}},computed:{tablePageData:function(){return this.tableData.slice((this.pagination.page-1)*this.pagination.rows,this.pagination.page*this.pagination.rows)}},watch:{"$store.getters.ws_message":function(t){if(1===t.type){var e=t.message;e.message=this.formatDetail(e.message),0===e.state&&this.$notify.error({title:e.projectName,dangerouslyUseHTMLString:!0,message:e.message,duration:0});var r=this.tableData.findIndex((function(t){return t.id===e.projectId}));if(-1!==r){var n=12.5*e.state;this.tableData[r].progressPercentage=n,this.tableData[r].progressStatus="warning",this.tableData[r].tagType="warning",this.tableData[r].tagText=e.message,0===n?(this.tableData[r].progressStatus="exception",this.tableData[r].tagType="danger",this.tableData[r].tagText="失败"):n>98&&(this.tableData[r].progressStatus="success",this.tableData[r].tagType="success"),this.tableData[r].deployState=e.state,this.tableData[r].publisherName=e.username,this.tableData[r].updateTime=Object(v["c"])(new Date)}}}},created:function(){this.getList(),this.getDeployGroupOption(),this.getUserOption()},methods:{parseTime:v["c"],handleGroupChange:function(t){localStorage.setItem("groupId",t),this.groupId=t,this.getList()},getDeployGroupOption:function(){var t=this;Object(h["c"])().then((function(e){t.groupOption=e.data.groupList||[]}))},getUserOption:function(){var t=this;Object(m["g"])().then((function(e){t.userOption=e.data.userList||[]}))},getList:function(){var t=this;u(this.groupId,this.projectName).then((function(e){var r=e.data.projectList||[];t.tableData=r.map((function(t){return t.progressPercentage=0,t.tagType="info",t.tagText="未构建",2===t.deployState?(t.progressPercentage=100,t.progressStatus="success",t.tagType="success",t.tagText="成功"):1===t.deployState&&(t.progressPercentage=60,t.progressStatus="warning",t.tagType="warning",t.tagText="构建中"),t})),t.pagination.total=t.tableData.length}))},handleSizeChange:function(t){this.pagination.rows=t,this.handlePageChange(1)},handlePageChange:function(t){this.pagination.page=t,this.getList()},publish:function(t){var e=this,r=t.id,n=this.$createElement,a="";a="生产环境"===t.environment?"color: #F56C6C":"测试环境"===t.environment?"color: #E6A23C":"color: #909399",this.$confirm("","提示",{message:n("p",null,[n("span",null,"此操作将部署 "+t.name),n("b",{style:a},"("+t.environment+")"),n("span",null,", 是否继续? ")]),confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.gitLog=[],e.remoteLog={},d(r,"").then((function(t){var n=e.tableData.findIndex((function(t){return t.id===r}));e.tableData[n].deployState=1}))})).catch((function(){e.$message({type:"info",message:"已取消构建"})}))},getDetail:function(){var t=this;p(this.publishToken).then((function(e){var r=e.data.publishTraceList||[];t.publishTraceList=r.map((function(t){return""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t})),t.publishLocalTraceList=t.publishTraceList.filter((function(t){return t.type<4})),t.publishRemoteTraceList={};var n,a=b(t.publishTraceList);try{for(a.s();!(n=a.n()).done;){var i=n.value;i.type<4||(t.publishRemoteTraceList[i.serverName]||(t.publishRemoteTraceList[i.serverName]=[]),t.publishRemoteTraceList[i.serverName].push(i))}}catch(o){a.e(o)}finally{a.f()}t.activeRomoteTracePane=Object.keys(t.publishRemoteTraceList)[0]}))},getPreviewList:function(){var t=this;this.searchPreview.loading=!0,f(this.previewPagination,{projectId:this.searchPreview.projectId,userId:this.searchPreview.userId||0,state:""===this.searchPreview.state?-1:this.searchPreview.state}).then((function(e){var r=e.data.gitTraceList||[];t.gitTraceList=r.map((function(t){return""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t.commit=t["commit"]?t["commit"].substring(0,6):"",t})),t.gitTraceList.length>0&&(t.publishToken=t.gitTraceList[0].token,t.getDetail()),t.previewPagination.total=e.data.pagination.total})).finally((function(){t.searchPreview.loading=!1}))},searchPreviewList:function(){this.handlePreviewPageChange(1)},handleDetail:function(t){this.dialogVisible=!0,this.searchPreview.projectId=t.id,this.searchPreview.userId="",this.searchPreview.state="",this.getPreviewList()},handlePreviewPageChange:function(t){this.previewPagination.page=t,this.getPreviewList()},handleDetailChange:function(t){this.publishToken=t,this.getDetail()},handlePublishCommand:function(t){var e=this,r=t.id;g(r).then((function(t){e.commitTableData=t.data.commitList.map((function(t){return Object.assign(t,{projectId:r})})),e.commitDialogVisible=!0}))},rollback:function(t){var e=this;this.$confirm("此操作将重新构建"+t.commit+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d(t.projectId,t.commit).then((function(r){var n=e.tableData.findIndex((function(e){return e.id===t.projectId}));e.tableData[n].deployState=1,e.commitDialogVisible=!1}))})).catch((function(){e.$message({type:"info",message:"已取消重新构建"})}))},findGroupName:function(t){var e=this.groupOption.find((function(e){return e.id===t}));return e?e["name"]:"默认"},formatDetail:function(t){return t?t.replace(/\n|(\r\n)/g,"<br>"):""}}},S=_,P=(r("ea20"),r("4023")),O=Object(P["a"])(S,n,a,!1,null,"8d9928d0",null);e["default"]=O.exports},"9cea":function(t,e,r){"use strict";e["a"]={data:function(){return{tableHeight:window.innerHeight-160}},mounted:function(){try{var t=document.getElementsByClassName("app-bar")[0].clientHeight+140,e=window.innerHeight-t;this.tableHeight=e}catch(r){console.log("缺少节点app-bar")}}}},a08d:function(t,e,r){e.f=r("cb3d")},e204:function(t,e,r){"use strict";var n=r("e46b"),a=r("013f")(6),i="findIndex",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),n(n.P+n.F*o,"Array",{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r("0e8b")(i)},e697:function(t,e,r){"use strict";var n=r("e46b"),a=r("013f")(5),i="find",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),n(n.P+n.F*o,"Array",{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r("0e8b")(i)},ea20:function(t,e,r){"use strict";var n=r("52aa"),a=r.n(n);a.a},ec25:function(t,e,r){"use strict";var n=r("4ce5"),a=r("e46b"),i=r("008a"),o=r("d0bc"),s=r("2285"),l=r("eafa"),c=r("ebc3"),u=r("f878");a(a.S+a.F*!r("d0c5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,r,a,p,f=i(t),g="function"==typeof this?this:Array,d=arguments.length,h=d>1?arguments[1]:void 0,m=void 0!==h,v=0,b=u(f);if(m&&(h=n(h,d>2?arguments[2]:void 0,2)),void 0==b||g==Array&&s(b))for(e=l(f.length),r=new g(e);e>v;v++)c(r,v,m?h(f[v],v):f[v]);else for(p=b.call(f),r=new g;!(a=p.next()).done;v++)c(r,v,m?o(p,h,[a.value,v],!0):a.value);return r.length=v,r}})},f091:function(t,e,r){var n=r("80a9"),a=r("2f77"),i=r("4f18");t.exports=function(t){var e=n(t),r=a.f;if(r){var o,s=r(t),l=i.f,c=0;while(s.length>c)l.call(t,o=s[c++])&&e.push(o)}return e}},f71f:function(t,e,r){var n=r("ec45")("meta"),a=r("fb68"),i=r("e042"),o=r("064e").f,s=0,l=Object.isExtensible||function(){return!0},c=!r("238a")((function(){return l(Object.preventExtensions({}))})),u=function(t){o(t,n,{value:{i:"O"+ ++s,w:{}}})},p=function(t,e){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,n)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[n].i},f=function(t,e){if(!i(t,n)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[n].w},g=function(t){return c&&d.NEED&&l(t)&&!i(t,n)&&u(t),t},d=t.exports={KEY:n,NEED:!1,fastKey:p,getWeak:f,onFreeze:g}}}]);