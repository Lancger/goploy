(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ac69a8c"],{"0a49":function(t,e,n){var r=n("9b43"),o=n("626a"),a=n("4bf8"),i=n("9def"),c=n("cd1c");t.exports=function(t,e){var n=1==t,l=2==t,s=3==t,u=4==t,p=6==t,f=5==t||p,m=e||c;return function(e,c,d){for(var b,v,h=a(e),g=o(h),_=r(c,d,3),y=i(g.length),w=0,S=n?m(e,y):l?m(e,0):void 0;y>w;w++)if((f||w in g)&&(b=g[w],v=_(b,w,h),t))if(n)S[w]=v;else if(v)switch(t){case 3:return!0;case 5:return b;case 6:return w;case 2:S.push(b)}else if(u)return!1;return p?-1:s||u?u:S}}},1169:function(t,e,n){var r=n("2d95");t.exports=Array.isArray||function(t){return"Array"==r(t)}},"20d6":function(t,e,n){"use strict";var r=n("5ca1"),o=n("0a49")(6),a="findIndex",i=!0;a in[]&&Array(1)[a](function(){i=!1}),r(r.P+r.F*i,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(a)},"23ba":function(t,e,n){"use strict";n.d(e,"d",function(){return a}),n.d(e,"e",function(){return i}),n.d(e,"c",function(){return c}),n.d(e,"a",function(){return l}),n.d(e,"b",function(){return s}),n.d(e,"f",function(){return u});var r=n("cebc"),o=n("b775");function a(t){return Object(o["a"])({url:"/group/getList",method:"get",params:Object(r["a"])({},t)})}function i(){return Object(o["a"])({url:"/group/getOption",method:"get"})}function c(){return Object(o["a"])({url:"/group/getDeployOption",method:"get"})}function l(t){return Object(o["a"])({url:"/group/add",method:"post",data:t})}function s(t){return Object(o["a"])({url:"/group/edit",method:"post",data:t})}function u(t){return Object(o["a"])({url:"/group/remove",method:"delete",data:{id:t}})}},"37c8":function(t,e,n){e.f=n("2b4c")},"3a72":function(t,e,n){var r=n("7726"),o=n("8378"),a=n("2d00"),i=n("37c8"),c=n("86cc").f;t.exports=function(t){var e=o.Symbol||(o.Symbol=a?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||c(e,t,{value:i.f(t)})}},"456d":function(t,e,n){var r=n("4bf8"),o=n("0d58");n("5eda")("keys",function(){return function(t){return o(r(t))}})},"5eda":function(t,e,n){var r=n("5ca1"),o=n("8378"),a=n("79e5");t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],i={};i[t]=e(n),r(r.S+r.F*a(function(){n(1)}),"Object",i)}},"67ab":function(t,e,n){var r=n("ca5a")("meta"),o=n("d3f4"),a=n("69a8"),i=n("86cc").f,c=0,l=Object.isExtensible||function(){return!0},s=!n("79e5")(function(){return l(Object.preventExtensions({}))}),u=function(t){i(t,r,{value:{i:"O"+ ++c,w:{}}})},p=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,r)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[r].i},f=function(t,e){if(!a(t,r)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[r].w},m=function(t){return s&&d.NEED&&l(t)&&!a(t,r)&&u(t),t},d=t.exports={KEY:r,NEED:!1,fastKey:p,getWeak:f,onFreeze:m}},7514:function(t,e,n){"use strict";var r=n("5ca1"),o=n("0a49")(5),a="find",i=!0;a in[]&&Array(1)[a](function(){i=!1}),r(r.P+r.F*i,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(a)},"78a4":function(t,e,n){"use strict";var r=n("c448"),o=n.n(r);o.a},"7bbc":function(t,e,n){var r=n("6821"),o=n("9093").f,a={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return o(t)}catch(e){return i.slice()}};t.exports.f=function(t){return i&&"[object Window]"==a.call(t)?c(t):o(r(t))}},"8a81":function(t,e,n){"use strict";var r=n("7726"),o=n("69a8"),a=n("9e1e"),i=n("5ca1"),c=n("2aba"),l=n("67ab").KEY,s=n("79e5"),u=n("5537"),p=n("7f20"),f=n("ca5a"),m=n("2b4c"),d=n("37c8"),b=n("3a72"),v=n("d4c0"),h=n("1169"),g=n("cb7c"),_=n("d3f4"),y=n("4bf8"),w=n("6821"),S=n("6a999"),T=n("4630"),k=n("2aeb"),x=n("7bbc"),O=n("11e9"),j=n("2621"),D=n("86cc"),L=n("0d58"),P=O.f,I=D.f,N=x.f,C=r.Symbol,E=r.JSON,F=E&&E.stringify,A="prototype",M=m("_hidden"),R=m("toPrimitive"),H={}.propertyIsEnumerable,V=u("symbol-registry"),J=u("symbols"),W=u("op-symbols"),$=Object[A],G="function"==typeof C&&!!j.f,B=r.QObject,K=!B||!B[A]||!B[A].findChild,Y=a&&s(function(){return 7!=k(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=P($,e);r&&delete $[e],I(t,e,n),r&&t!==$&&I($,e,r)}:I,z=function(t){var e=J[t]=k(C[A]);return e._k=t,e},Q=G&&"symbol"==typeof C.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof C},U=function(t,e,n){return t===$&&U(W,e,n),g(t),e=S(e,!0),g(n),o(J,e)?(n.enumerable?(o(t,M)&&t[M][e]&&(t[M][e]=!1),n=k(n,{enumerable:T(0,!1)})):(o(t,M)||I(t,M,T(1,{})),t[M][e]=!0),Y(t,e,n)):I(t,e,n)},q=function(t,e){g(t);var n,r=v(e=w(e)),o=0,a=r.length;while(a>o)U(t,n=r[o++],e[n]);return t},X=function(t,e){return void 0===e?k(t):q(k(t),e)},Z=function(t){var e=H.call(this,t=S(t,!0));return!(this===$&&o(J,t)&&!o(W,t))&&(!(e||!o(this,t)||!o(J,t)||o(this,M)&&this[M][t])||e)},tt=function(t,e){if(t=w(t),e=S(e,!0),t!==$||!o(J,e)||o(W,e)){var n=P(t,e);return!n||!o(J,e)||o(t,M)&&t[M][e]||(n.enumerable=!0),n}},et=function(t){var e,n=N(w(t)),r=[],a=0;while(n.length>a)o(J,e=n[a++])||e==M||e==l||r.push(e);return r},nt=function(t){var e,n=t===$,r=N(n?W:w(t)),a=[],i=0;while(r.length>i)!o(J,e=r[i++])||n&&!o($,e)||a.push(J[e]);return a};G||(C=function(){if(this instanceof C)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===$&&e.call(W,n),o(this,M)&&o(this[M],t)&&(this[M][t]=!1),Y(this,t,T(1,n))};return a&&K&&Y($,t,{configurable:!0,set:e}),z(t)},c(C[A],"toString",function(){return this._k}),O.f=tt,D.f=U,n("9093").f=x.f=et,n("52a7").f=Z,j.f=nt,a&&!n("2d00")&&c($,"propertyIsEnumerable",Z,!0),d.f=function(t){return z(m(t))}),i(i.G+i.W+i.F*!G,{Symbol:C});for(var rt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ot=0;rt.length>ot;)m(rt[ot++]);for(var at=L(m.store),it=0;at.length>it;)b(at[it++]);i(i.S+i.F*!G,"Symbol",{for:function(t){return o(V,t+="")?V[t]:V[t]=C(t)},keyFor:function(t){if(!Q(t))throw TypeError(t+" is not a symbol!");for(var e in V)if(V[e]===t)return e},useSetter:function(){K=!0},useSimple:function(){K=!1}}),i(i.S+i.F*!G,"Object",{create:X,defineProperty:U,defineProperties:q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:nt});var ct=s(function(){j.f(1)});i(i.S+i.F*ct,"Object",{getOwnPropertySymbols:function(t){return j.f(y(t))}}),E&&i(i.S+i.F*(!G||s(function(){var t=C();return"[null]"!=F([t])||"{}"!=F({a:t})||"{}"!=F(Object(t))})),"JSON",{stringify:function(t){var e,n,r=[t],o=1;while(arguments.length>o)r.push(arguments[o++]);if(n=e=r[1],(_(e)||void 0!==t)&&!Q(t))return h(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Q(e))return e}),r[1]=e,F.apply(E,r)}}),C[A][R]||n("32e9")(C[A],R,C[A].valueOf),p(C,"Symbol"),p(Math,"Math",!0),p(r.JSON,"JSON",!0)},"9b7a":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",{staticClass:"app-container"},[n("el-row",{staticClass:"app-bar",attrs:{type:"flex"}},[n("el-select",{attrs:{placeholder:"选择分组"},on:{change:t.handleGroupChange},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},[n("el-option",{attrs:{label:"默认",value:0}}),t._v(" "),t._l(t.groupOption,function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t.id}})})],2),t._v(" "),n("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入项目名称"},on:{change:t.getList},model:{value:t.projectName,callback:function(e){t.projectName=e},expression:"projectName"}})],1),t._v(" "),n("el-table",{staticStyle:{width:"100%","margin-top":"5px"},attrs:{border:"",stripe:"","highlight-current-row":"",data:t.tableData}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"项目名称","min-width":"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return["生产环境"===e.row.environment?n("b",{staticStyle:{color:"#F56C6C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):"测试环境"===e.row.environment?n("b",{staticStyle:{color:"#E6A23C"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))]):n("b",{staticStyle:{color:"#909399"}},[t._v(t._s(e.row.name)+" - "+t._s(e.row.environment))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"group",label:"分组"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.findGroupName(e.row.groupId))+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"branch",label:"分支"}}),t._v(" "),n("el-table-column",{attrs:{prop:"publisherName",label:"构建者",width:"160"}}),t._v(" "),n("el-table-column",{attrs:{prop:"deployState",label:"构建状态",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.deployState?n("el-tag",{attrs:{type:"info",effect:"plain"}},[t._v("未构建")]):1===e.row.deployState?n("el-tag",{attrs:{type:"warning",effect:"plain"}},[t._v("构建中")]):2===e.row.deployState?n("el-tag",{attrs:{type:"success",effect:"plain"}},[t._v("成功")]):n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"updateTime",label:"上次构建时间",width:"160"}}),t._v(" "),n("el-table-column",{attrs:{prop:"operation",label:"操作",width:"175",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-dropdown",{staticClass:"publish-btn",attrs:{"split-button":"",trigger:"click",disabled:1===e.row.deployState,type:"primary"},on:{click:function(n){return t.publish(e.row)},command:t.handlePublishCommand}},[t._v("\n          构建\n          "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:e.row}},[t._v("选择具体commit")])],1)],1),t._v(" "),n("el-button",{attrs:{type:"success"},on:{click:function(n){return t.handleDetail(e.row)}}},[t._v("详情")])]}}])})],1),t._v(" "),n("el-dialog",{staticClass:"publish-record",attrs:{title:"构建记录",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-row",[n("el-col",{attrs:{span:8}},[n("el-radio-group",{on:{change:t.handleDetailChange},model:{value:t.publishToken,callback:function(e){t.publishToken=e},expression:"publishToken"}},t._l(t.gitTraceList,function(e,r){return n("el-row",{key:r},[n("el-row",{staticStyle:{margin:"5px 0"}},[n("el-radio",{staticStyle:{"margin-left":"10px","margin-right":"5px","padding-right":"8px",width:"210px"},attrs:{label:e.token,border:""}},[t._v("\n                "+t._s(e.publisherName)+" commitID: "+t._s(e.commit)+"\n                "),1===e.publishState?n("span",{staticStyle:{color:"#67C23A",float:"right","line-height":"16px"}},[t._v("成功")]):n("span",{staticStyle:{color:"#F56C6C",float:"right","line-height":"16px"}},[t._v("失败")])]),t._v(" "),n("el-button",{attrs:{type:"danger",plain:""},on:{click:function(n){return t.rollback(e)}}},[t._v("rebuild")])],1)],1)}),1)],1),t._v(" "),n("el-col",{staticClass:"project-detail",attrs:{span:16}},[t._l(t.publishLocalTraceList,function(e,r){return n("el-row",{key:r},[2===e.type?n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("git同步信息")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),0!==e.state?n("el-row",[n("el-row",[t._v("commit: "+t._s(e["commit"]))]),t._v(" "),n("el-row",[t._v("message: "+t._s(e["message"]))]),t._v(" "),n("el-row",[t._v("author: "+t._s(e["author"]))]),t._v(" "),n("el-row",[t._v("datetime: "+t._s(e["timestamp"]?t.parseTime(e["timestamp"]):""))]),t._v(" "),n("el-row",[n("span",{domProps:{innerHTML:t._s(t.formatDetail(e["diff"]))}})])],1):n("el-row",{staticStyle:{margin:"5px 0"}},[n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):t._e(),t._v(" "),3===e.type?n("el-row",[n("hr"),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("获取代码后脚本信息")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("脚本: "),n("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("el-row",[t._v("[goploy ~]# "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):t._e(),t._v(" "),6===e.type?n("el-row",[n("hr"),t._v(" "),n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("remote服务器信息")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("服务器: "+t._s(e.serverName))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("脚本: "+t._s(e.script))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1)],1):t._e()],1)}),t._v(" "),n("hr"),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("目标服务器")]),t._v(" "),n("el-tabs",{model:{value:t.activeRomoteTracePane,callback:function(e){t.activeRomoteTracePane=e},expression:"activeRomoteTracePane"}},t._l(t.publishRemoteTraceList,function(e,r){return n("el-tab-pane",{key:r,attrs:{label:r,name:r}},t._l(e,function(e,r){return n("el-row",{key:r},[4===e.type?n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署前脚本")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("脚本: "),n("pre",{domProps:{innerHTML:t._s(t.formatDetail(e.script))}})]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("el-row",[t._v("[goploy ~]# "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1):5===e.type?n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("rsync同步文件")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("命令: "+t._s(e.command))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})],1)],1):n("el-row",[n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("部署后脚本")]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[t._v("时间: "+t._s(e.createTime))]),t._v(" "),n("el-row",[t._v("脚本: "+t._s(e.script))]),t._v(" "),n("el-row",{staticStyle:{margin:"5px 0"}},[0===e.state?n("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("失败")]):t._e(),t._v(" "),n("el-row",[t._v("[goploy ~]# "),n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.detail))}})])],1)],1)],1)}),1)}),1)],2)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"commit管理",visible:t.commitDialogVisible},on:{"update:visible":function(e){t.commitDialogVisible=e}}},[n("el-table",{attrs:{border:"",stripe:"","highlight-current-row":"","max-height":"447px",data:t.commitTableData}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{domProps:{innerHTML:t._s(t.formatDetail(e.row.diff))}})]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"commit",label:"commit",width:"290"}}),t._v(" "),n("el-table-column",{attrs:{prop:"author",label:"author"}}),t._v(" "),n("el-table-column",{attrs:{label:"提交时间",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.parseTime(e.row.timestamp))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"message",label:"message",width:"200","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{prop:"operation",label:"操作",width:"80",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"danger"},on:{click:function(n){return t.rollback(e.row)}}},[t._v("构建")])]}}])})],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.commitDialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},o=[],a=(n("a481"),n("7514"),n("ac4d"),n("8a81"),n("456d"),n("7f7f"),n("ac6a"),n("20d6"),n("b775"));function i(t,e){return Object(a["a"])({url:"/deploy/getList",method:"get",params:{groupId:t,projectName:e}})}function c(t){return Object(a["a"])({url:"/deploy/getDetail",method:"get",params:{lastPublishToken:t}})}function l(t){return Object(a["a"])({url:"/deploy/getPreview",method:"get",params:{projectId:t}})}function s(t){return Object(a["a"])({url:"/deploy/getCommitList",method:"get",params:{id:t}})}function u(t,e){return Object(a["a"])({url:"/deploy/publish",method:"post",data:{projectId:t,commit:e}})}var p=n("23ba"),f=n("ed08"),m={data:function(){return{groupId:parseInt(localStorage.getItem("groupId"))||0,groupOption:[],projectName:"",publishToken:"",commitDialogVisible:!1,dialogVisible:!1,webSocket:null,tableData:[],commitTableData:[],gitTraceList:[],publishTraceList:[],publishLocalTraceList:[],publishRemoteTraceList:{},activeRomoteTracePane:""}},created:function(){var t=this;this.getList(),this.getDeployGroupOption(),this.connectWebSocket(),this.$router.afterEach(function(){t.webSocket&&t.webSocket.close()})},methods:{parseTime:f["c"],connectWebSocket:function(){var t=this;return this.webSocket&&this.webSocket.readyState<2?(console.log("reusing the socket connection [state = "+this.webSocket.readyState+"]: "+this.webSocket.url),Promise.resolve(this.webSocket)):new Promise(function(e,n){t.webSocket=new WebSocket("ws://"+window.location.host+"/ws/broadcast"),t.webSocket.onopen=function(){console.log("socket connection is opened [state = "+t.webSocket.readyState+"]: "+t.webSocket.url),e(t.webSocket)},t.webSocket.onerror=function(t){console.error("socket connection error : ",t),n(t)},t.webSocket.onclose=function(e){t.webSocket=null,console.log("connection closed ("+e.code+")")},t.webSocket.onmessage=function(e){var n=JSON.parse(e.data);console.log(n),n.message=t.formatDetail(n.message),3===n.state&&t.$notify.error({title:n.projectName,dangerouslyUseHTMLString:!0,message:n.message,duration:0});var r=t.tableData.findIndex(function(t){return t.id===n.projectId});-1!==r&&(t.tableData[r].deployState=n.state,t.tableData[r].publisherName=n.username,t.tableData[r].updateTime=Object(f["c"])(new Date))}})},handleGroupChange:function(t){localStorage.setItem("groupId",t),this.groupId=t,this.getList()},getDeployGroupOption:function(){var t=this;Object(p["c"])().then(function(e){t.groupOption=e.data.groupList||[]})},getList:function(){var t=this;i(this.groupId,this.projectName).then(function(e){var n=e.data.projectList||[];n.forEach(function(t){t.createTime=Object(f["c"])(t.createTime),t.updateTime=Object(f["c"])(t.updateTime)}),t.tableData=n})},publish:function(t){var e=this,n=t.id,r=this.$createElement,o="";o="生产环境"===t.environment?"color: #F56C6C":"测试环境"===t.environment?"color: #E6A23C":"color: #909399",this.$confirm("","提示",{message:r("p",null,[r("span",null,"此操作将部署 "+t.name),r("b",{style:o},"("+t.environment+")"),r("span",null,", 是否继续? ")]),confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.gitLog=[],e.remoteLog={},e.connectWebSocket().then(function(t){u(n,"").then(function(t){var r=e.tableData.findIndex(function(t){return t.id===n});e.tableData[r].deployState=1})})}).catch(function(){e.$message({type:"info",message:"已取消构建"})})},getDetail:function(){var t=this;c(this.publishToken).then(function(e){var n=e.data.publishTraceList||[];t.publishTraceList=n.map(function(t){return t.createTime=Object(f["c"])(t.createTime),""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t}),t.publishLocalTraceList=t.publishTraceList.filter(function(t){return t.type<4}),t.publishRemoteTraceList={};var r=!0,o=!1,a=void 0;try{for(var i,c=t.publishTraceList[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var l=i.value;l.type<4||(t.publishRemoteTraceList[l.serverName]||(t.publishRemoteTraceList[l.serverName]=[]),t.publishRemoteTraceList[l.serverName].push(l))}}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}t.activeRomoteTracePane=Object.keys(t.publishRemoteTraceList)[0]})},handleDetail:function(t){var e=this;this.dialogVisible=!0,l(t.id).then(function(t){var n=t.data.gitTraceList||[];e.gitTraceList=n.map(function(t){return""!==t.ext&&Object.assign(t,JSON.parse(t.ext)),t.commit=t["commit"]?t["commit"].substring(0,6):"",t}),e.gitTraceList.length>0&&(e.publishToken=e.gitTraceList[0].token,e.getDetail())})},handleDetailChange:function(t){this.publishToken=t,this.getDetail()},handlePublishCommand:function(t){var e=this,n=t.id;s(n).then(function(t){e.commitTableData=t.data.commitList.map(function(t){return Object.assign(t,{projectId:n})}),e.commitDialogVisible=!0})},rollback:function(t){var e=this;this.$confirm("此操作将重新构建"+t.commit+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.connectWebSocket().then(function(n){u(t.projectId,t.commit).then(function(n){var r=e.tableData.findIndex(function(e){return e.id===t.projectId});e.tableData[r].deployState=1,e.commitDialogVisible=!1})})}).catch(function(){e.$message({type:"info",message:"已取消重新构建"})})},findGroupName:function(t){var e=this.groupOption.find(function(e){return e.id===t});return e?e["name"]:"默认"},formatDetail:function(t){return t?t.replace(/\n|(\r\n)/g,"<br>"):""}}},d=m,b=(n("78a4"),n("2877")),v=Object(b["a"])(d,r,o,!1,null,"07c7c9d3",null);e["default"]=v.exports},ac4d:function(t,e,n){n("3a72")("asyncIterator")},c448:function(t,e,n){},cd1c:function(t,e,n){var r=n("e853");t.exports=function(t,e){return new(r(t))(e)}},d4c0:function(t,e,n){var r=n("0d58"),o=n("2621"),a=n("52a7");t.exports=function(t){var e=r(t),n=o.f;if(n){var i,c=n(t),l=a.f,s=0;while(c.length>s)l.call(t,i=c[s++])&&e.push(i)}return e}},e853:function(t,e,n){var r=n("d3f4"),o=n("1169"),a=n("2b4c")("species");t.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),r(e)&&(e=e[a],null===e&&(e=void 0))),void 0===e?Array:e}}}]);